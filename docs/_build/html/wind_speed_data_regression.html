

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Wind Speed Data: Regression Models &#8212; Parcial Machine Learning 2023-30</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'wind_speed_data_regression';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Fraud Detection Data: EDA" href="fraud_detection_data_EDA.html" />
    <link rel="prev" title="Wind Speed Data: EDA" href="wind_speed_data_EDA.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Parcial Machine Learning 2023-30
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="wind_speed_data_EDA.html">Wind Speed Data: EDA</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Wind Speed Data: Regression Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="fraud_detection_data_EDA.html">Fraud Detection Data: EDA</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fwind_speed_data_regression.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/wind_speed_data_regression.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Wind Speed Data: Regression Models</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#disenando-loop-para-particiones-de-entrenamiento-y-validacion">Diseñando loop para particiones de entrenamiento y validación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">KNN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-regression">Ridge Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-regression">Lasso Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xg-boost">XG Boost</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#svm">SVM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp">MLP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">Conclusiones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitaciones">Limitaciones</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="wind-speed-data-regression-models">
<h1>Wind Speed Data: Regression Models<a class="headerlink" href="#wind-speed-data-regression-models" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">column_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;HORA (UTC)&#39;</span><span class="p">:</span> <span class="s1">&#39;Hora (UTC)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))&#39;</span><span class="p">:</span> <span class="s1">&#39;Dirección del Viento (grados)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VENTO, VELOCIDADE HORARIA (m/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;Velocidad del Viento (m/s)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)&#39;</span><span class="p">:</span> <span class="s1">&#39;Humedad Relativa Máxima (AUT) (%)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)&#39;</span><span class="p">:</span> <span class="s1">&#39;Humedad Relativa Mínima (AUT) (%)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperatura Máxima (AUT) (°C)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)&#39;</span><span class="p">:</span> <span class="s1">&#39;Temperatura Mínima (AUT) (°C)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UMIDADE RELATIVA DO AR, HORARIA (%)&#39;</span><span class="p">:</span> <span class="s1">&#39;Humedad Relativa del Aire (%)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)&#39;</span><span class="p">:</span> <span class="s1">&#39;Presión Atmosférica Horaria (mB)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)&#39;</span><span class="p">:</span> <span class="s1">&#39;Precipitación Total Horaria (mm)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;VENTO, RAJADA MAXIMA (m/s)&#39;</span><span class="p">:</span> <span class="s1">&#39;Rajada Máxima del Viento (m/s)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)&#39;</span><span class="p">:</span> <span class="s1">&#39;Presión Atmosférica Máxima Anterior (AUT) (mB)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)&#39;</span><span class="p">:</span> <span class="s1">&#39;Presión Atmosférica Mínima Anterior (AUT) (mB)&#39;</span>
<span class="p">}</span>

<span class="n">wind_speed_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;wind_speed_data_treino_dv_df_2000_2010.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">)</span>

<span class="n">wind_speed_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Hora (UTC)</th>
      <th>Dirección del Viento (grados)</th>
      <th>Velocidad del Viento (m/s)</th>
      <th>Humedad Relativa Máxima (AUT) (%)</th>
      <th>Humedad Relativa Mínima (AUT) (%)</th>
      <th>Temperatura Máxima (AUT) (°C)</th>
      <th>Temperatura Mínima (AUT) (°C)</th>
      <th>Humedad Relativa del Aire (%)</th>
      <th>Presión Atmosférica Horaria (mB)</th>
      <th>Precipitación Total Horaria (mm)</th>
      <th>Rajada Máxima del Viento (m/s)</th>
      <th>Presión Atmosférica Máxima Anterior (AUT) (mB)</th>
      <th>Presión Atmosférica Mínima Anterior (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="p">[[</span><span class="s2">&quot;Dirección del Viento (grados)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Humedad Relativa del Aire (%)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Precipitación Total Horaria (mm)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Rajada Máxima del Viento (m/s)&quot;</span><span class="p">]]</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">wind_speed_data</span><span class="p">[[</span><span class="s2">&quot;Velocidad del Viento (m/s)&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<section id="disenando-loop-para-particiones-de-entrenamiento-y-validacion">
<h2>Diseñando loop para particiones de entrenamiento y validación<a class="headerlink" href="#disenando-loop-para-particiones-de-entrenamiento-y-validacion" title="Permalink to this heading">#</a></h2>
<p>El objetivo de este ciclo, es el de en cada iteración aumentar en uno el número de días que se utilizan para entrenar, mientras se utiliza el día siguiente para testear.</p>
<p>Entonces, en cada iteración el dataset de entrenamiento incremente su tamaño en 24 registros.</p>
<p>Tal que:</p>
<ul class="simple">
<li><p>1ra iteración</p>
<ul>
<li><p>X_train, y_train -&gt; primeros 24 registros</p></li>
<li><p>X_test, y_test -&gt; los 24 registros que le siguen</p></li>
</ul>
</li>
<li><p>2da iteración</p>
<ul>
<li><p>X_train, y_train -&gt; primeros 48 registros</p></li>
<li><p>X_test, y_test -&gt; los 24 registros que le siguen</p></li>
</ul>
</li>
<li><p>3ra iteración</p>
<ul>
<li><p>X_train, y_train -&gt; primeros 72 registros</p></li>
<li><p>X_test, y_test -&gt; los 24 registros que le siguen</p></li>
</ul>
</li>
</ul>
<p>Esto funciona en este caso dado que el dataset está previamente ordenado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># aqui range indica el numero de folds que se va a crear,</span>
<span class="c1"># se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
<span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

    <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
    
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
    
    <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">fold</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X_train shape:&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y_train shape:&quot;</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;X_test shape:&quot;</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;y_test shape:&quot;</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration 1:
X_train shape: (24, 4)
y_train shape: (24, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 2:
X_train shape: (48, 4)
y_train shape: (48, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 3:
X_train shape: (72, 4)
y_train shape: (72, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 4:
X_train shape: (96, 4)
y_train shape: (96, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 5:
X_train shape: (120, 4)
y_train shape: (120, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 6:
X_train shape: (144, 4)
y_train shape: (144, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 7:
X_train shape: (168, 4)
y_train shape: (168, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 8:
X_train shape: (192, 4)
y_train shape: (192, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 9:
X_train shape: (216, 4)
y_train shape: (216, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
Iteration 10:
X_train shape: (240, 4)
y_train shape: (240, 1)
X_test shape: (24, 4)
y_test shape: (24, 1)
==============================
</pre></div>
</div>
</div>
</div>
<p>una vez se ha verificado que el ciclo funciona como es debido, se procede con la comparación de modelos</p>
</section>
<section id="knn">
<h2>KNN<a class="headerlink" href="#knn" title="Permalink to this heading">#</a></h2>
<p>En este modelo, se itera sobre el número de vecinos. En este caso, el número mínimo de vecinos debe ser mayor o igual al número de registros. Dado que nuestro primer fold tiene 24 registros, el número máximo de vecinos sobre los que se puede iterar es 24. A continuación se define la <strong>grid</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">neighbors_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># grilla de parametros a probar en knn regressor</span>
<span class="n">neighbors_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">]</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="k">for</span> <span class="n">n_neighbors</span> <span class="ow">in</span> <span class="n">neighbors_grid</span><span class="p">:</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># entrenamiento del modelo</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">n_neighbors</span><span class="p">)</span>
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>      
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">):</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">n_neighbors</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Número óptimo de vecinos: </span><span class="si">{</span><span class="n">best_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor RMSE: </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número óptimo de vecinos: 20
Mejor RMSE: 0.8228921248988412
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">best_params</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7899717535076868
</pre></div>
</div>
</div>
</div>
<p>Con base en los resultados, se puede concluir:</p>
<ul class="simple">
<li><p>El RMSE más bajo fué 0.8228 con 20 vecinos.</p></li>
<li><p>El <span class="math notranslate nohighlight">\(R^2\)</span> fué de 0.789, lo cuál indica que proximadamente el 78.99% de la variabilidad en la variable dependiente se puede explicar mediante las variables independientes.</p></li>
</ul>
</section>
<section id="ridge-regression">
<h2>Ridge Regression<a class="headerlink" href="#ridge-regression" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>

<span class="c1"># grilla de parametros a probar en Ridge</span>
<span class="n">alpha_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alpha_grid</span><span class="p">:</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># entrenamiento del modelo</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parámetro de regularización óptimo: </span><span class="si">{</span><span class="n">best_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor RMSE: </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parámetro de regularización óptimo: 100
Mejor RMSE: 0.8568079989572535
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">best_params</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7736758933900864
</pre></div>
</div>
</div>
</div>
<p>Nótese que en este caso, el mejor parámetro de regularización es 100, con un RMSE de 0.85 y <span class="math notranslate nohighlight">\(R^2\)</span> de 0.77</p>
</section>
<section id="lasso-regression">
<h2>Lasso Regression<a class="headerlink" href="#lasso-regression" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>

<span class="c1"># grilla de parametros a probar en Lasso</span>
<span class="n">alpha_grid</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alpha_grid</span><span class="p">:</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># entrenamiento del modelo</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parámetro de regularización óptimo: </span><span class="si">{</span><span class="n">best_params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor RMSE: </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parámetro de regularización óptimo: 0.1
Mejor RMSE: 0.8576640106793569
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">best_params</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7551466718568816
</pre></div>
</div>
</div>
</div>
<p>Nótese que en este caso, el mejor parámetro de regularización es 0.1, con un RMSE de 0.857 y <span class="math notranslate nohighlight">\(R^2\)</span> de 0.755</p>
</section>
<section id="xg-boost">
<h2>XG Boost<a class="headerlink" href="#xg-boost" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>

<span class="c1"># grilla de parametros a probar en XGBoost</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="c1"># Se crea una lista de diccionarios representando todas las posibles combinaciones</span>
<span class="n">param_combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">param_grid</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">param_combinations</span><span class="p">:</span>
    <span class="c1"># Desempaquetando los parámetros</span>
    <span class="n">n_estimators</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="n">params</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># entrenamiento del modelo</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span>
            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
            <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span>
            <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span>
        <span class="p">)</span>
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">optim_n_estimators</span><span class="p">,</span> <span class="n">optim_learning_rate</span><span class="p">,</span> <span class="n">optim_max_depth</span> <span class="o">=</span> <span class="n">params</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parámetros mas optimos:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Número de árboles: </span><span class="si">{</span><span class="n">optim_n_estimators</span><span class="si">}</span><span class="s2"> , learning_rate </span><span class="si">{</span><span class="n">optim_learning_rate</span><span class="si">}</span><span class="s2"> , max_depth </span><span class="si">{</span><span class="n">optim_max_depth</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor RMSE: </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parámetros mas optimos:
Número de árboles: 50 , learning_rate 0.1 , max_depth 3
Mejor RMSE: 0.856827578604703
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span>
            <span class="n">n_estimators</span><span class="o">=</span><span class="n">optim_n_estimators</span><span class="p">,</span>
            <span class="n">learning_rate</span><span class="o">=</span><span class="n">optim_learning_rate</span><span class="p">,</span>
            <span class="n">max_depth</span><span class="o">=</span><span class="n">optim_max_depth</span>
        <span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7962835744986132
</pre></div>
</div>
</div>
</div>
<p>Con lo cuál el mejor modelo resulta de tener 50 árboles, con un learning rate de 0.1 y una profundidad máxima de 3 nodos. Para un RMSE de 0.856 y <span class="math notranslate nohighlight">\(R^2\)</span> de 0.796</p>
</section>
<section id="svm">
<h2>SVM<a class="headerlink" href="#svm" title="Permalink to this heading">#</a></h2>
<p>Nota aclaratoria, en este caso se es consciente que no tienen ningún sentido utilizar el parámetro gamma cuando el kernel es ‘linear’</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">svr_grid</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rbf&#39;</span><span class="p">],</span>
               <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
               <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
               <span class="s1">&#39;epsilon&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span>
              
              <span class="p">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">],</span>
               <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
               <span class="s1">&#39;epsilon&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]}]</span>
</pre></div>
</div>
<p>Sin embargo no se diseña el grid tal como el que se acaba de mostrar, porque se tuvo un problema en el desempaquetado de las variables al momento de diseñar los loops, por lo cuál se procede a resolver este tema con un condicional</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>

<span class="c1"># grilla de parametros a probar en SVM</span>
<span class="n">svr_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">],</span>
            <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s1">&#39;epsilon&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="p">}</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="c1"># Se crea una lista de diccionarios representando todas las posibles combinaciones</span>
<span class="n">param_combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">svr_grid</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">param_combinations</span><span class="p">:</span>
    <span class="c1"># Desempaquetando los parámetros</span>
    <span class="n">kernel</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="n">params</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># entrenamiento del modelo</span>
        <span class="k">if</span><span class="p">(</span><span class="n">kernel</span> <span class="o">==</span> <span class="s1">&#39;rbf&#39;</span><span class="p">):</span>
            <span class="n">reg</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span>
                <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
                <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span>
                <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span>
                <span class="n">epsilon</span><span class="o">=</span><span class="n">epsilon</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">reg</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span>
                <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
                <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span>
                <span class="n">epsilon</span><span class="o">=</span><span class="n">epsilon</span>
            <span class="p">)</span>
            
        <span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parámetros mas optimos:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">best_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor RMSE: </span><span class="si">{</span><span class="n">lowest_rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parámetros mas optimos:
(&#39;rbf&#39;, 0.1, 0.1, 0.1)
Mejor RMSE: 0.8153139388461801
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span>
    <span class="n">kernel</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">C</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">gamma</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">epsilon</span><span class="o">=</span><span class="n">best_params</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7927637862454311
</pre></div>
</div>
</div>
</div>
<p>Con lo cuál el mejor modelo resulta de tener un kernel gaussiano, con un término de regularización, valor de gamma y valor de épsilon de 0.1. Para un RMSE de 0.8153 y <span class="math notranslate nohighlight">\(R^2\)</span> de 0.7927</p>
</section>
<section id="mlp">
<h2>MLP<a class="headerlink" href="#mlp" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="c1"># grilla de parametros a probar en SVM</span>
<span class="n">mlp_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;neurons_layer_1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
            <span class="s1">&#39;neurons_layer_2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
            <span class="p">}</span>

<span class="c1"># aqui range indica el numero de folds que se va a crear, se limita porque hay demasiados folds de 24 horas</span>
<span class="n">num_folds</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>

<span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

<span class="n">n_cols</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Se crea una lista de diccionarios representando todas las posibles combinaciones</span>
<span class="n">param_combinations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">mlp_grid</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

<span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">param_combinations</span><span class="p">:</span>
    <span class="c1"># Desempaquetando los parámetros</span>
    <span class="n">neurons_layer_1</span><span class="p">,</span> <span class="n">neurons_layer_2</span> <span class="o">=</span> <span class="n">params</span>
    
    <span class="n">final_index</span> <span class="o">=</span> <span class="mi">24</span>
    
    <span class="c1"># lista para guardar las metricas en cada fold</span>
    <span class="n">rmse_in_fold</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="n">num_folds</span><span class="p">:</span>

        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">final_index</span><span class="p">]</span>
        
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">final_index</span><span class="p">:</span><span class="n">final_index</span> <span class="o">+</span> <span class="mi">24</span><span class="p">]</span>
        
        <span class="n">final_index</span> <span class="o">+=</span> <span class="mi">24</span>
        
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># Set up the model: model</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>

        <span class="c1"># Add the first layer</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">neurons_layer_1</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_cols</span><span class="p">,)))</span>

        <span class="c1"># Add the second layer</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">neurons_layer_2</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>

        <span class="c1"># Add the output layer</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

        <span class="c1"># Compile the model</span>
        <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>

        <span class="c1"># Fit the model</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># calculando RMSE</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">rmse_in_fold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
        
    <span class="n">rmse_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse_in_fold</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">rmse_mean</span> <span class="o">&lt;</span> <span class="n">lowest_rmse</span><span class="p">:</span>
        <span class="n">best_params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="n">lowest_rmse</span> <span class="o">=</span> <span class="n">rmse_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1/1 [==============================] - 1s 655ms/step - loss: 3.6275
1/1 [==============================] - 0s 86ms/step
2/2 [==============================] - 1s 4ms/step - loss: 3.2823
1/1 [==============================] - 0s 63ms/step
3/3 [==============================] - 1s 0s/step - loss: 1.6161
1/1 [==============================] - 0s 79ms/step
3/3 [==============================] - 0s 0s/step - loss: 4.1406
1/1 [==============================] - 0s 71ms/step
4/4 [==============================] - 1s 5ms/step - loss: 3.5171
1/1 [==============================] - 0s 60ms/step
5/5 [==============================] - 1s 0s/step - loss: 6.3997
1/1 [==============================] - 0s 76ms/step
6/6 [==============================] - 1s 3ms/step - loss: 9.2121
1/1 [==============================] - 0s 71ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.6002
1/1 [==============================] - 0s 77ms/step
7/7 [==============================] - 1s 2ms/step - loss: 6.1816
1/1 [==============================] - 0s 73ms/step
8/8 [==============================] - 1s 2ms/step - loss: 5.6219
1/1 [==============================] - 0s 65ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.0582
1/1 [==============================] - 0s 79ms/step
9/9 [==============================] - 1s 2ms/step - loss: 4.5633
1/1 [==============================] - 0s 69ms/step
10/10 [==============================] - 1s 3ms/step - loss: 7.3203
1/1 [==============================] - 0s 100ms/step
11/11 [==============================] - 1s 2ms/step - loss: 5.9552
1/1 [==============================] - 0s 105ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.2744
1/1 [==============================] - 0s 64ms/step
12/12 [==============================] - 1s 4ms/step - loss: 5.3328
1/1 [==============================] - 0s 79ms/step
13/13 [==============================] - 1s 4ms/step - loss: 6.6321
1/1 [==============================] - 0s 82ms/step
14/14 [==============================] - 1s 3ms/step - loss: 5.6701
1/1 [==============================] - 0s 90ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.9309
1/1 [==============================] - 0s 118ms/step
15/15 [==============================] - 1s 3ms/step - loss: 5.5055
1/1 [==============================] - 0s 98ms/step
16/16 [==============================] - 1s 2ms/step - loss: 5.8210
1/1 [==============================] - 0s 82ms/step
17/17 [==============================] - 1s 3ms/step - loss: 4.5157
1/1 [==============================] - 0s 420ms/step
18/18 [==============================] - 1s 2ms/step - loss: 6.7027
1/1 [==============================] - 0s 84ms/step
18/18 [==============================] - 1s 2ms/step - loss: 6.6646
1/1 [==============================] - 0s 84ms/step
19/19 [==============================] - 1s 2ms/step - loss: 7.6542
1/1 [==============================] - 0s 71ms/step
20/20 [==============================] - 1s 3ms/step - loss: 7.3108
1/1 [==============================] - 0s 93ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.9767
1/1 [==============================] - 0s 83ms/step
21/21 [==============================] - 1s 3ms/step - loss: 7.3296
1/1 [==============================] - 0s 87ms/step
22/22 [==============================] - 1s 3ms/step - loss: 4.7617
1/1 [==============================] - 0s 85ms/step
23/23 [==============================] - 1s 3ms/step - loss: 7.8805
1/1 [==============================] - 0s 80ms/step
24/24 [==============================] - 1s 2ms/step - loss: 5.9076
1/1 [==============================] - 0s 86ms/step
24/24 [==============================] - 1s 3ms/step - loss: 7.0518
1/1 [==============================] - 0s 82ms/step
25/25 [==============================] - 1s 2ms/step - loss: 7.1331
1/1 [==============================] - 0s 79ms/step
26/26 [==============================] - 1s 3ms/step - loss: 6.4832
1/1 [==============================] - 0s 78ms/step
27/27 [==============================] - 1s 3ms/step - loss: 8.0764
1/1 [==============================] - 0s 74ms/step
27/27 [==============================] - 1s 2ms/step - loss: 6.7239
1/1 [==============================] - 0s 88ms/step
28/28 [==============================] - 1s 2ms/step - loss: 6.7625
1/1 [==============================] - 0s 77ms/step
29/29 [==============================] - 1s 3ms/step - loss: 4.5068
1/1 [==============================] - 0s 96ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.1047
1/1 [==============================] - 0s 62ms/step
30/30 [==============================] - 1s 3ms/step - loss: 9.9499
1/1 [==============================] - 0s 87ms/step
31/31 [==============================] - 1s 3ms/step - loss: 6.6734
1/1 [==============================] - 0s 65ms/step
32/32 [==============================] - 1s 3ms/step - loss: 7.6787
1/1 [==============================] - 0s 79ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.5021
1/1 [==============================] - 0s 77ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.5184
1/1 [==============================] - 0s 94ms/step
34/34 [==============================] - 1s 2ms/step - loss: 6.5401
1/1 [==============================] - 0s 85ms/step
35/35 [==============================] - 1s 2ms/step - loss: 8.2443
1/1 [==============================] - 0s 70ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.0786
1/1 [==============================] - 0s 89ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.8022
1/1 [==============================] - 0s 82ms/step
37/37 [==============================] - 1s 3ms/step - loss: 8.7591
1/1 [==============================] - 0s 78ms/step
38/38 [==============================] - 1s 3ms/step - loss: 5.9931
1/1 [==============================] - 0s 103ms/step
1/1 [==============================] - 1s 679ms/step - loss: 3.0759
1/1 [==============================] - 0s 99ms/step
2/2 [==============================] - 1s 6ms/step - loss: 2.8811
1/1 [==============================] - 0s 103ms/step
3/3 [==============================] - 1s 4ms/step - loss: 4.0871
1/1 [==============================] - 0s 76ms/step
3/3 [==============================] - 1s 8ms/step - loss: 3.9110
1/1 [==============================] - 0s 118ms/step
4/4 [==============================] - 1s 5ms/step - loss: 4.8145
1/1 [==============================] - 0s 83ms/step
5/5 [==============================] - 1s 3ms/step - loss: 2.4930
1/1 [==============================] - 0s 83ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.2414
1/1 [==============================] - 0s 75ms/step
6/6 [==============================] - 1s 5ms/step - loss: 7.5462
1/1 [==============================] - 0s 99ms/step
7/7 [==============================] - 1s 3ms/step - loss: 5.8164
1/1 [==============================] - 0s 97ms/step
8/8 [==============================] - 1s 2ms/step - loss: 5.2590
1/1 [==============================] - 0s 96ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.7589
1/1 [==============================] - 0s 85ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.2602
1/1 [==============================] - 0s 94ms/step
10/10 [==============================] - 1s 3ms/step - loss: 5.2376
1/1 [==============================] - 0s 79ms/step
11/11 [==============================] - 1s 3ms/step - loss: 4.8913
1/1 [==============================] - 0s 100ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.2147
1/1 [==============================] - 0s 89ms/step
12/12 [==============================] - 0s 3ms/step - loss: 6.2800
1/1 [==============================] - 0s 72ms/step
13/13 [==============================] - 1s 2ms/step - loss: 7.1058
1/1 [==============================] - 0s 82ms/step
14/14 [==============================] - 1s 3ms/step - loss: 5.4400
1/1 [==============================] - 0s 80ms/step
15/15 [==============================] - 1s 3ms/step - loss: 8.8996
1/1 [==============================] - 0s 80ms/step
15/15 [==============================] - 0s 3ms/step - loss: 7.6825
1/1 [==============================] - 0s 76ms/step
16/16 [==============================] - 1s 3ms/step - loss: 4.7947
1/1 [==============================] - 0s 90ms/step
17/17 [==============================] - 1s 3ms/step - loss: 4.7935
1/1 [==============================] - 0s 86ms/step
18/18 [==============================] - 1s 3ms/step - loss: 5.7925
1/1 [==============================] - 0s 77ms/step
18/18 [==============================] - 1s 3ms/step - loss: 6.9253
1/1 [==============================] - 0s 83ms/step
19/19 [==============================] - 1s 3ms/step - loss: 6.7538
1/1 [==============================] - 0s 94ms/step
20/20 [==============================] - 1s 3ms/step - loss: 7.3101
1/1 [==============================] - 0s 77ms/step
21/21 [==============================] - 1s 3ms/step - loss: 8.3800
1/1 [==============================] - 0s 73ms/step
21/21 [==============================] - 1s 2ms/step - loss: 6.6517
1/1 [==============================] - 0s 79ms/step
22/22 [==============================] - 1s 3ms/step - loss: 7.0925
1/1 [==============================] - 0s 69ms/step
23/23 [==============================] - 1s 3ms/step - loss: 5.8224
1/1 [==============================] - 0s 87ms/step
24/24 [==============================] - 1s 3ms/step - loss: 7.4909
1/1 [==============================] - 0s 72ms/step
24/24 [==============================] - 1s 3ms/step - loss: 4.9385
1/1 [==============================] - 0s 96ms/step
25/25 [==============================] - 1s 3ms/step - loss: 5.5308
1/1 [==============================] - 0s 87ms/step
26/26 [==============================] - 1s 3ms/step - loss: 7.5802
1/1 [==============================] - 0s 81ms/step
27/27 [==============================] - 1s 3ms/step - loss: 6.8689
1/1 [==============================] - 0s 143ms/step
27/27 [==============================] - 1s 3ms/step - loss: 6.0713
1/1 [==============================] - 0s 113ms/step
28/28 [==============================] - 1s 3ms/step - loss: 6.4007
1/1 [==============================] - 0s 113ms/step
29/29 [==============================] - 1s 3ms/step - loss: 3.8181
1/1 [==============================] - 0s 88ms/step
30/30 [==============================] - 1s 3ms/step - loss: 9.0822
1/1 [==============================] - 0s 117ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.2667
1/1 [==============================] - 0s 99ms/step
31/31 [==============================] - 1s 3ms/step - loss: 4.9765
1/1 [==============================] - 0s 94ms/step
32/32 [==============================] - 1s 3ms/step - loss: 6.8607
1/1 [==============================] - 0s 97ms/step
33/33 [==============================] - 1s 2ms/step - loss: 6.3195
1/1 [==============================] - 0s 81ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.5270
1/1 [==============================] - 0s 63ms/step
34/34 [==============================] - 1s 3ms/step - loss: 6.1844
1/1 [==============================] - 0s 81ms/step
35/35 [==============================] - 1s 3ms/step - loss: 7.8374
1/1 [==============================] - 0s 81ms/step
36/36 [==============================] - 1s 2ms/step - loss: 5.0282
1/1 [==============================] - 0s 88ms/step
36/36 [==============================] - 1s 3ms/step - loss: 3.9205
1/1 [==============================] - 0s 86ms/step
37/37 [==============================] - 1s 3ms/step - loss: 4.7922
1/1 [==============================] - 0s 97ms/step
38/38 [==============================] - 1s 3ms/step - loss: 6.2843
1/1 [==============================] - 0s 88ms/step
1/1 [==============================] - 1s 612ms/step - loss: 3.8822
1/1 [==============================] - 0s 82ms/step
2/2 [==============================] - 1s 0s/step - loss: 4.7671
1/1 [==============================] - 0s 83ms/step
3/3 [==============================] - 1s 4ms/step - loss: 5.0328
1/1 [==============================] - 0s 96ms/step
3/3 [==============================] - 1s 0s/step - loss: 3.9038
1/1 [==============================] - 0s 87ms/step
4/4 [==============================] - 1s 5ms/step - loss: 4.6927
1/1 [==============================] - 0s 89ms/step
5/5 [==============================] - 1s 5ms/step - loss: 6.0382
1/1 [==============================] - 0s 106ms/step
6/6 [==============================] - 1s 2ms/step - loss: 7.1503
1/1 [==============================] - 0s 83ms/step
6/6 [==============================] - 0s 4ms/step - loss: 6.5958
1/1 [==============================] - 0s 110ms/step
7/7 [==============================] - 1s 3ms/step - loss: 9.5911
1/1 [==============================] - 0s 105ms/step
8/8 [==============================] - 1s 3ms/step - loss: 4.7107
1/1 [==============================] - 0s 90ms/step
9/9 [==============================] - 1s 2ms/step - loss: 4.6577
1/1 [==============================] - 0s 83ms/step
9/9 [==============================] - 1s 2ms/step - loss: 5.4319
1/1 [==============================] - 0s 115ms/step
10/10 [==============================] - 1s 3ms/step - loss: 6.5251
1/1 [==============================] - 0s 89ms/step
11/11 [==============================] - 1s 2ms/step - loss: 5.5835
1/1 [==============================] - 0s 64ms/step
12/12 [==============================] - 1s 2ms/step - loss: 7.1026
1/1 [==============================] - 0s 77ms/step
12/12 [==============================] - 1s 1ms/step - loss: 6.8042
1/1 [==============================] - 0s 68ms/step
13/13 [==============================] - 1s 3ms/step - loss: 6.1589
1/1 [==============================] - 0s 83ms/step
14/14 [==============================] - 1s 2ms/step - loss: 6.2866
1/1 [==============================] - 0s 83ms/step
15/15 [==============================] - 1s 2ms/step - loss: 5.8944
1/1 [==============================] - 0s 69ms/step
15/15 [==============================] - 0s 2ms/step - loss: 5.0497
1/1 [==============================] - 0s 68ms/step
16/16 [==============================] - 1s 2ms/step - loss: 4.8790
1/1 [==============================] - 0s 70ms/step
17/17 [==============================] - 1s 3ms/step - loss: 5.4204
1/1 [==============================] - 0s 82ms/step
18/18 [==============================] - 1s 3ms/step - loss: 5.8331
1/1 [==============================] - 0s 71ms/step
18/18 [==============================] - 1s 2ms/step - loss: 6.3250
1/1 [==============================] - 0s 76ms/step
19/19 [==============================] - 1s 3ms/step - loss: 4.9989
1/1 [==============================] - 0s 73ms/step
20/20 [==============================] - 1s 3ms/step - loss: 4.8834
1/1 [==============================] - 0s 67ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.1369
1/1 [==============================] - 0s 75ms/step
21/21 [==============================] - 1s 2ms/step - loss: 6.9007
1/1 [==============================] - 0s 60ms/step
22/22 [==============================] - 1s 3ms/step - loss: 6.8583
1/1 [==============================] - 0s 65ms/step
23/23 [==============================] - 1s 2ms/step - loss: 4.2117
1/1 [==============================] - 0s 79ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.4000
1/1 [==============================] - 0s 74ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.5364
1/1 [==============================] - 0s 72ms/step
25/25 [==============================] - 1s 2ms/step - loss: 5.7280
1/1 [==============================] - 0s 62ms/step
26/26 [==============================] - 1s 3ms/step - loss: 7.9941
1/1 [==============================] - 0s 70ms/step
27/27 [==============================] - 1s 3ms/step - loss: 6.7715
1/1 [==============================] - 0s 66ms/step
27/27 [==============================] - 1s 2ms/step - loss: 4.3306
1/1 [==============================] - 0s 75ms/step
28/28 [==============================] - 1s 2ms/step - loss: 6.2259
1/1 [==============================] - 0s 71ms/step
29/29 [==============================] - 1s 2ms/step - loss: 6.5757
1/1 [==============================] - 0s 73ms/step
30/30 [==============================] - 1s 3ms/step - loss: 5.9590
1/1 [==============================] - 0s 75ms/step
30/30 [==============================] - 1s 3ms/step - loss: 5.7844
1/1 [==============================] - 0s 77ms/step
31/31 [==============================] - 1s 2ms/step - loss: 6.0086
1/1 [==============================] - 0s 75ms/step
32/32 [==============================] - 1s 3ms/step - loss: 7.0977
1/1 [==============================] - 0s 72ms/step
33/33 [==============================] - 1s 3ms/step - loss: 7.4111
1/1 [==============================] - 0s 77ms/step
33/33 [==============================] - 1s 3ms/step - loss: 7.4301
1/1 [==============================] - 0s 78ms/step
34/34 [==============================] - 1s 2ms/step - loss: 6.7785
1/1 [==============================] - 0s 63ms/step
35/35 [==============================] - 1s 3ms/step - loss: 5.9264
1/1 [==============================] - 0s 70ms/step
36/36 [==============================] - 1s 2ms/step - loss: 6.2983
1/1 [==============================] - 0s 61ms/step
36/36 [==============================] - 1s 2ms/step - loss: 6.2140
1/1 [==============================] - 0s 71ms/step
37/37 [==============================] - 1s 2ms/step - loss: 5.4148
1/1 [==============================] - 0s 84ms/step
38/38 [==============================] - 1s 2ms/step - loss: 6.7207
1/1 [==============================] - 0s 94ms/step
1/1 [==============================] - 1s 686ms/step - loss: 2.6625
1/1 [==============================] - 0s 98ms/step
2/2 [==============================] - 1s 0s/step - loss: 3.6701
1/1 [==============================] - 0s 103ms/step
3/3 [==============================] - 1s 3ms/step - loss: 3.1018
1/1 [==============================] - 0s 90ms/step
3/3 [==============================] - 0s 8ms/step - loss: 4.3219
1/1 [==============================] - 0s 85ms/step
4/4 [==============================] - 1s 8ms/step - loss: 4.0340
1/1 [==============================] - 0s 128ms/step
5/5 [==============================] - 1s 2ms/step - loss: 5.8965
1/1 [==============================] - 0s 121ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.6379
1/1 [==============================] - 0s 78ms/step
6/6 [==============================] - 1s 4ms/step - loss: 6.7593
1/1 [==============================] - 0s 91ms/step
7/7 [==============================] - 1s 3ms/step - loss: 5.6785
1/1 [==============================] - 0s 73ms/step
8/8 [==============================] - 1s 2ms/step - loss: 6.3503
1/1 [==============================] - 0s 72ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.1253
1/1 [==============================] - 0s 93ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.9442
1/1 [==============================] - 0s 89ms/step
10/10 [==============================] - 1s 4ms/step - loss: 5.9855
1/1 [==============================] - 0s 65ms/step
11/11 [==============================] - 1s 3ms/step - loss: 5.0631
1/1 [==============================] - 0s 78ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.1006
1/1 [==============================] - 0s 95ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.0078
1/1 [==============================] - 0s 95ms/step
13/13 [==============================] - 1s 3ms/step - loss: 5.2207
1/1 [==============================] - 0s 149ms/step
14/14 [==============================] - 1s 3ms/step - loss: 6.2858
1/1 [==============================] - 0s 83ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.8505
1/1 [==============================] - 0s 215ms/step
15/15 [==============================] - 1s 2ms/step - loss: 6.7834
1/1 [==============================] - 0s 92ms/step
16/16 [==============================] - 1s 2ms/step - loss: 5.6718
1/1 [==============================] - 0s 85ms/step
17/17 [==============================] - 1s 2ms/step - loss: 5.0617
1/1 [==============================] - 0s 91ms/step
18/18 [==============================] - 1s 3ms/step - loss: 3.6977
1/1 [==============================] - 0s 80ms/step
18/18 [==============================] - 1s 3ms/step - loss: 5.7627
1/1 [==============================] - 0s 74ms/step
19/19 [==============================] - 1s 3ms/step - loss: 6.5776
1/1 [==============================] - 0s 94ms/step
20/20 [==============================] - 1s 2ms/step - loss: 5.5105
1/1 [==============================] - 0s 81ms/step
21/21 [==============================] - 1s 2ms/step - loss: 6.7143
1/1 [==============================] - 0s 76ms/step
21/21 [==============================] - 1s 3ms/step - loss: 5.1898
1/1 [==============================] - 0s 87ms/step
22/22 [==============================] - 1s 3ms/step - loss: 6.4409
1/1 [==============================] - 0s 99ms/step
23/23 [==============================] - 1s 3ms/step - loss: 7.0285
1/1 [==============================] - 0s 80ms/step
24/24 [==============================] - 1s 3ms/step - loss: 4.6579
1/1 [==============================] - 0s 82ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.2570
1/1 [==============================] - 0s 77ms/step
25/25 [==============================] - 1s 3ms/step - loss: 5.2660
1/1 [==============================] - 0s 102ms/step
26/26 [==============================] - 1s 2ms/step - loss: 6.7118
1/1 [==============================] - 0s 116ms/step
27/27 [==============================] - 1s 3ms/step - loss: 7.1944
1/1 [==============================] - 0s 102ms/step
27/27 [==============================] - 1s 3ms/step - loss: 4.9900
1/1 [==============================] - 0s 91ms/step
28/28 [==============================] - 1s 3ms/step - loss: 6.0495
1/1 [==============================] - 0s 98ms/step
29/29 [==============================] - 1s 3ms/step - loss: 6.5299
1/1 [==============================] - 0s 73ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.9154
1/1 [==============================] - 0s 87ms/step
30/30 [==============================] - 1s 3ms/step - loss: 5.4645
1/1 [==============================] - 0s 97ms/step
31/31 [==============================] - 1s 4ms/step - loss: 5.5127
1/1 [==============================] - 0s 87ms/step
32/32 [==============================] - 1s 3ms/step - loss: 6.9516
1/1 [==============================] - 0s 87ms/step
33/33 [==============================] - 1s 3ms/step - loss: 5.2526
1/1 [==============================] - 0s 85ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.8182
1/1 [==============================] - 0s 91ms/step
34/34 [==============================] - 1s 3ms/step - loss: 5.6250
1/1 [==============================] - 0s 93ms/step
35/35 [==============================] - 1s 3ms/step - loss: 6.4421
1/1 [==============================] - 0s 89ms/step
36/36 [==============================] - 1s 3ms/step - loss: 7.2203
1/1 [==============================] - 0s 106ms/step
36/36 [==============================] - 1s 4ms/step - loss: 5.6628
1/1 [==============================] - 0s 147ms/step
37/37 [==============================] - 1s 3ms/step - loss: 5.3360
1/1 [==============================] - 0s 89ms/step
38/38 [==============================] - 1s 3ms/step - loss: 5.9064
1/1 [==============================] - 0s 95ms/step
1/1 [==============================] - 1s 635ms/step - loss: 3.2298
1/1 [==============================] - 0s 95ms/step
2/2 [==============================] - 1s 4ms/step - loss: 1.8772
1/1 [==============================] - 0s 95ms/step
3/3 [==============================] - 1s 2ms/step - loss: 4.2759
1/1 [==============================] - 0s 83ms/step
3/3 [==============================] - 1s 4ms/step - loss: 5.0707
1/1 [==============================] - 0s 80ms/step
4/4 [==============================] - 1s 3ms/step - loss: 3.9311
1/1 [==============================] - 0s 94ms/step
5/5 [==============================] - 1s 3ms/step - loss: 5.9532
1/1 [==============================] - 0s 93ms/step
6/6 [==============================] - 1s 4ms/step - loss: 7.8215
1/1 [==============================] - 0s 85ms/step
6/6 [==============================] - 1s 3ms/step - loss: 5.8702
1/1 [==============================] - 0s 86ms/step
7/7 [==============================] - 1s 3ms/step - loss: 5.8228
1/1 [==============================] - 0s 92ms/step
8/8 [==============================] - 1s 3ms/step - loss: 7.1509
1/1 [==============================] - 0s 95ms/step
9/9 [==============================] - 1s 3ms/step - loss: 6.0394
1/1 [==============================] - 0s 82ms/step
9/9 [==============================] - 1s 3ms/step - loss: 3.9346
1/1 [==============================] - 0s 89ms/step
10/10 [==============================] - 1s 3ms/step - loss: 2.8009
1/1 [==============================] - 0s 96ms/step
11/11 [==============================] - 1s 3ms/step - loss: 7.6236
1/1 [==============================] - 0s 88ms/step
12/12 [==============================] - 1s 3ms/step - loss: 4.8135
1/1 [==============================] - 0s 85ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.9022
1/1 [==============================] - 0s 91ms/step
13/13 [==============================] - 1s 3ms/step - loss: 5.4686
1/1 [==============================] - 0s 84ms/step
14/14 [==============================] - 1s 3ms/step - loss: 6.7541
1/1 [==============================] - 0s 104ms/step
15/15 [==============================] - 1s 4ms/step - loss: 5.9418
1/1 [==============================] - 0s 96ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.5113
1/1 [==============================] - 0s 90ms/step
16/16 [==============================] - 1s 2ms/step - loss: 6.7984
1/1 [==============================] - 0s 91ms/step
17/17 [==============================] - 1s 2ms/step - loss: 4.8309
1/1 [==============================] - 0s 75ms/step
18/18 [==============================] - 1s 3ms/step - loss: 2.9729
1/1 [==============================] - 0s 81ms/step
18/18 [==============================] - 1s 3ms/step - loss: 3.6347
1/1 [==============================] - 0s 84ms/step
19/19 [==============================] - 1s 3ms/step - loss: 5.0349
1/1 [==============================] - 0s 82ms/step
20/20 [==============================] - 1s 5ms/step - loss: 7.1319
1/1 [==============================] - 0s 98ms/step
21/21 [==============================] - 1s 3ms/step - loss: 5.0949
1/1 [==============================] - 0s 87ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.9416
1/1 [==============================] - 0s 105ms/step
22/22 [==============================] - 1s 3ms/step - loss: 4.8514
1/1 [==============================] - 0s 92ms/step
23/23 [==============================] - 1s 3ms/step - loss: 2.9749
1/1 [==============================] - 0s 91ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.3217
1/1 [==============================] - 0s 91ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.4775
1/1 [==============================] - 0s 81ms/step
25/25 [==============================] - 1s 3ms/step - loss: 5.8976
1/1 [==============================] - 0s 84ms/step
26/26 [==============================] - 1s 3ms/step - loss: 6.2314
1/1 [==============================] - 0s 105ms/step
27/27 [==============================] - 1s 3ms/step - loss: 6.6716
1/1 [==============================] - 0s 112ms/step
27/27 [==============================] - 1s 4ms/step - loss: 7.7750
1/1 [==============================] - 0s 85ms/step
28/28 [==============================] - 1s 3ms/step - loss: 6.2673
1/1 [==============================] - 0s 97ms/step
29/29 [==============================] - 1s 3ms/step - loss: 6.7451
1/1 [==============================] - 0s 106ms/step
30/30 [==============================] - 1s 4ms/step - loss: 4.8281
1/1 [==============================] - 0s 108ms/step
30/30 [==============================] - 1s 3ms/step - loss: 3.0219
1/1 [==============================] - 0s 90ms/step
31/31 [==============================] - 1s 2ms/step - loss: 5.5159
1/1 [==============================] - 0s 91ms/step
32/32 [==============================] - 1s 3ms/step - loss: 7.3421
1/1 [==============================] - 0s 113ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.5959
1/1 [==============================] - 0s 83ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.1157
1/1 [==============================] - 0s 103ms/step
34/34 [==============================] - 1s 2ms/step - loss: 4.3319
1/1 [==============================] - 0s 83ms/step
35/35 [==============================] - 1s 3ms/step - loss: 7.3564
1/1 [==============================] - 0s 84ms/step
36/36 [==============================] - 1s 3ms/step - loss: 3.8577
1/1 [==============================] - 0s 82ms/step
36/36 [==============================] - 1s 2ms/step - loss: 6.4146
1/1 [==============================] - 0s 95ms/step
37/37 [==============================] - 1s 3ms/step - loss: 4.4462
1/1 [==============================] - 0s 85ms/step
38/38 [==============================] - 1s 3ms/step - loss: 4.9396
1/1 [==============================] - 0s 87ms/step
1/1 [==============================] - 1s 549ms/step - loss: 2.4433
1/1 [==============================] - 0s 79ms/step
2/2 [==============================] - 1s 6ms/step - loss: 3.3626
1/1 [==============================] - 0s 82ms/step
3/3 [==============================] - 1s 4ms/step - loss: 5.4374
1/1 [==============================] - 0s 79ms/step
3/3 [==============================] - 1s 4ms/step - loss: 7.1565
1/1 [==============================] - 0s 87ms/step
4/4 [==============================] - 1s 3ms/step - loss: 5.9923
1/1 [==============================] - 0s 85ms/step
5/5 [==============================] - 1s 3ms/step - loss: 5.8677
1/1 [==============================] - 0s 77ms/step
6/6 [==============================] - 1s 2ms/step - loss: 6.2521
1/1 [==============================] - 0s 88ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.1631
1/1 [==============================] - 0s 82ms/step
7/7 [==============================] - 1s 3ms/step - loss: 6.8468
1/1 [==============================] - 0s 72ms/step
8/8 [==============================] - 1s 3ms/step - loss: 7.7367
1/1 [==============================] - 0s 83ms/step
9/9 [==============================] - 1s 3ms/step - loss: 6.8444
1/1 [==============================] - 0s 80ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.0219
1/1 [==============================] - 0s 80ms/step
10/10 [==============================] - 1s 3ms/step - loss: 8.0071
1/1 [==============================] - 0s 85ms/step
11/11 [==============================] - 1s 3ms/step - loss: 7.8575
1/1 [==============================] - 0s 81ms/step
12/12 [==============================] - 1s 2ms/step - loss: 7.4839
1/1 [==============================] - 0s 80ms/step
12/12 [==============================] - 1s 2ms/step - loss: 7.6508
1/1 [==============================] - 0s 83ms/step
13/13 [==============================] - 1s 3ms/step - loss: 6.2424
1/1 [==============================] - 0s 82ms/step
14/14 [==============================] - 1s 2ms/step - loss: 3.2670
1/1 [==============================] - 0s 75ms/step
15/15 [==============================] - 1s 3ms/step - loss: 5.6984
1/1 [==============================] - 0s 82ms/step
15/15 [==============================] - 0s 2ms/step - loss: 4.7488
1/1 [==============================] - 0s 76ms/step
16/16 [==============================] - 1s 3ms/step - loss: 6.0787
1/1 [==============================] - 0s 90ms/step
17/17 [==============================] - 1s 3ms/step - loss: 7.4959
1/1 [==============================] - 0s 84ms/step
18/18 [==============================] - 1s 3ms/step - loss: 4.4214
1/1 [==============================] - 0s 87ms/step
18/18 [==============================] - 1s 2ms/step - loss: 5.1219
1/1 [==============================] - 0s 83ms/step
19/19 [==============================] - 1s 3ms/step - loss: 5.9285
1/1 [==============================] - 0s 88ms/step
20/20 [==============================] - 1s 3ms/step - loss: 5.3055
1/1 [==============================] - 0s 89ms/step
21/21 [==============================] - 1s 2ms/step - loss: 5.5832
1/1 [==============================] - 0s 81ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.1841
1/1 [==============================] - 0s 79ms/step
22/22 [==============================] - 1s 3ms/step - loss: 6.1982
1/1 [==============================] - 0s 78ms/step
23/23 [==============================] - 1s 3ms/step - loss: 7.9009
1/1 [==============================] - 0s 88ms/step
24/24 [==============================] - 1s 3ms/step - loss: 4.7560
1/1 [==============================] - 0s 72ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.1184
1/1 [==============================] - 0s 83ms/step
25/25 [==============================] - 1s 3ms/step - loss: 6.8019
1/1 [==============================] - 0s 93ms/step
26/26 [==============================] - 1s 2ms/step - loss: 7.1696
1/1 [==============================] - 0s 79ms/step
27/27 [==============================] - 1s 3ms/step - loss: 5.7677
1/1 [==============================] - 0s 80ms/step
27/27 [==============================] - 1s 3ms/step - loss: 3.1519
1/1 [==============================] - 0s 74ms/step
28/28 [==============================] - 1s 3ms/step - loss: 8.3123
1/1 [==============================] - 0s 81ms/step
29/29 [==============================] - 1s 3ms/step - loss: 8.5336
1/1 [==============================] - 0s 79ms/step
30/30 [==============================] - 1s 3ms/step - loss: 9.7855
1/1 [==============================] - 0s 461ms/step
30/30 [==============================] - 1s 2ms/step - loss: 4.3149
1/1 [==============================] - 0s 86ms/step
31/31 [==============================] - 1s 3ms/step - loss: 7.8826
1/1 [==============================] - 0s 90ms/step
32/32 [==============================] - 1s 3ms/step - loss: 10.1321
1/1 [==============================] - 0s 87ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.4918
1/1 [==============================] - 0s 93ms/step
33/33 [==============================] - 1s 3ms/step - loss: 5.0932
1/1 [==============================] - 0s 84ms/step
34/34 [==============================] - 1s 3ms/step - loss: 6.2037
1/1 [==============================] - 0s 86ms/step
35/35 [==============================] - 1s 3ms/step - loss: 5.9298
1/1 [==============================] - 0s 79ms/step
36/36 [==============================] - 1s 2ms/step - loss: 5.3200
1/1 [==============================] - 0s 87ms/step
36/36 [==============================] - 1s 2ms/step - loss: 6.2669
1/1 [==============================] - 0s 84ms/step
37/37 [==============================] - 1s 3ms/step - loss: 5.3890
1/1 [==============================] - 0s 81ms/step
38/38 [==============================] - 1s 2ms/step - loss: 3.8311
1/1 [==============================] - 0s 88ms/step
1/1 [==============================] - 1s 551ms/step - loss: 3.0741
1/1 [==============================] - 0s 81ms/step
2/2 [==============================] - 1s 5ms/step - loss: 4.5753
1/1 [==============================] - 0s 83ms/step
3/3 [==============================] - 1s 4ms/step - loss: 3.4889
1/1 [==============================] - 0s 80ms/step
3/3 [==============================] - 0s 3ms/step - loss: 4.4036
1/1 [==============================] - 0s 82ms/step
4/4 [==============================] - 1s 3ms/step - loss: 5.3139
1/1 [==============================] - 0s 450ms/step
5/5 [==============================] - 1s 3ms/step - loss: 8.5567
1/1 [==============================] - 0s 90ms/step
6/6 [==============================] - 1s 2ms/step - loss: 7.5095
1/1 [==============================] - 0s 85ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.3669
1/1 [==============================] - 0s 87ms/step
7/7 [==============================] - 1s 3ms/step - loss: 4.8625
1/1 [==============================] - 0s 79ms/step
8/8 [==============================] - 1s 3ms/step - loss: 5.1302
1/1 [==============================] - 0s 80ms/step
9/9 [==============================] - 1s 3ms/step - loss: 6.4252
1/1 [==============================] - 0s 90ms/step
9/9 [==============================] - 1s 3ms/step - loss: 4.8508
1/1 [==============================] - 0s 87ms/step
10/10 [==============================] - 1s 2ms/step - loss: 7.5161
1/1 [==============================] - 0s 87ms/step
11/11 [==============================] - 1s 3ms/step - loss: 4.6571
1/1 [==============================] - 0s 79ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.0539
1/1 [==============================] - 0s 82ms/step
12/12 [==============================] - 1s 3ms/step - loss: 7.6725
1/1 [==============================] - 0s 93ms/step
13/13 [==============================] - 1s 3ms/step - loss: 5.3821
1/1 [==============================] - 0s 82ms/step
14/14 [==============================] - 1s 3ms/step - loss: 4.7918
1/1 [==============================] - 0s 79ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.3207
1/1 [==============================] - 0s 79ms/step
15/15 [==============================] - 1s 3ms/step - loss: 7.0401
1/1 [==============================] - 0s 85ms/step
16/16 [==============================] - 1s 3ms/step - loss: 6.6435
1/1 [==============================] - 0s 82ms/step
17/17 [==============================] - 1s 3ms/step - loss: 6.5141
1/1 [==============================] - 0s 85ms/step
18/18 [==============================] - 1s 3ms/step - loss: 5.0067
1/1 [==============================] - 0s 81ms/step
18/18 [==============================] - 1s 3ms/step - loss: 4.3544
1/1 [==============================] - 0s 90ms/step
19/19 [==============================] - 1s 3ms/step - loss: 5.2688
1/1 [==============================] - 0s 107ms/step
20/20 [==============================] - 1s 2ms/step - loss: 5.1647
1/1 [==============================] - 0s 81ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.6106
1/1 [==============================] - 0s 88ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.2074
1/1 [==============================] - 0s 84ms/step
22/22 [==============================] - 1s 3ms/step - loss: 9.0145
1/1 [==============================] - 0s 86ms/step
23/23 [==============================] - 1s 3ms/step - loss: 3.8589
1/1 [==============================] - 0s 85ms/step
24/24 [==============================] - 1s 3ms/step - loss: 4.5711
1/1 [==============================] - 0s 86ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.2481
1/1 [==============================] - 0s 87ms/step
25/25 [==============================] - 1s 3ms/step - loss: 5.4252
1/1 [==============================] - 0s 86ms/step
26/26 [==============================] - 1s 3ms/step - loss: 5.8076
1/1 [==============================] - 0s 104ms/step
27/27 [==============================] - 1s 3ms/step - loss: 6.4143
1/1 [==============================] - 0s 86ms/step
27/27 [==============================] - 1s 3ms/step - loss: 5.4239
1/1 [==============================] - 0s 97ms/step
28/28 [==============================] - 1s 3ms/step - loss: 5.4507
1/1 [==============================] - 0s 89ms/step
29/29 [==============================] - 1s 3ms/step - loss: 6.9011
1/1 [==============================] - 0s 79ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.3412
1/1 [==============================] - 0s 81ms/step
30/30 [==============================] - 1s 3ms/step - loss: 4.7441
1/1 [==============================] - 0s 82ms/step
31/31 [==============================] - 1s 3ms/step - loss: 5.7844
1/1 [==============================] - 0s 84ms/step
32/32 [==============================] - 1s 3ms/step - loss: 6.1743
1/1 [==============================] - 0s 86ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.4658
1/1 [==============================] - 0s 87ms/step
33/33 [==============================] - 1s 3ms/step - loss: 3.9700
1/1 [==============================] - 0s 79ms/step
34/34 [==============================] - 1s 3ms/step - loss: 4.8515
1/1 [==============================] - 0s 92ms/step
35/35 [==============================] - 1s 3ms/step - loss: 7.5966
1/1 [==============================] - 0s 84ms/step
36/36 [==============================] - 1s 2ms/step - loss: 5.2436
1/1 [==============================] - 0s 80ms/step
36/36 [==============================] - 1s 3ms/step - loss: 4.3917
1/1 [==============================] - 0s 85ms/step
37/37 [==============================] - 1s 3ms/step - loss: 5.2708
1/1 [==============================] - 0s 83ms/step
38/38 [==============================] - 1s 3ms/step - loss: 6.2802
1/1 [==============================] - 0s 86ms/step
1/1 [==============================] - 1s 691ms/step - loss: 2.6347
1/1 [==============================] - 0s 79ms/step
2/2 [==============================] - 1s 6ms/step - loss: 3.1034
1/1 [==============================] - 0s 80ms/step
3/3 [==============================] - 1s 5ms/step - loss: 4.1084
1/1 [==============================] - 0s 80ms/step
3/3 [==============================] - 0s 4ms/step - loss: 4.5768
1/1 [==============================] - 0s 84ms/step
4/4 [==============================] - 1s 3ms/step - loss: 6.2442
1/1 [==============================] - 0s 86ms/step
5/5 [==============================] - 1s 3ms/step - loss: 7.2473
1/1 [==============================] - 0s 74ms/step
6/6 [==============================] - 1s 3ms/step - loss: 5.2383
1/1 [==============================] - 0s 78ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.6232
1/1 [==============================] - 0s 90ms/step
7/7 [==============================] - 1s 3ms/step - loss: 5.8261
1/1 [==============================] - 0s 99ms/step
8/8 [==============================] - 1s 2ms/step - loss: 6.2794
1/1 [==============================] - 0s 83ms/step
9/9 [==============================] - 1s 3ms/step - loss: 4.4922
1/1 [==============================] - 0s 88ms/step
9/9 [==============================] - 1s 2ms/step - loss: 5.1325
1/1 [==============================] - 0s 86ms/step
10/10 [==============================] - 1s 3ms/step - loss: 5.9672
1/1 [==============================] - 0s 111ms/step
11/11 [==============================] - 1s 3ms/step - loss: 7.3150
1/1 [==============================] - 0s 81ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.1129
1/1 [==============================] - 0s 94ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.2175
1/1 [==============================] - 0s 78ms/step
13/13 [==============================] - 1s 3ms/step - loss: 7.1382
1/1 [==============================] - 0s 81ms/step
14/14 [==============================] - 1s 3ms/step - loss: 5.2546
1/1 [==============================] - 0s 87ms/step
15/15 [==============================] - 1s 3ms/step - loss: 7.6442
1/1 [==============================] - 0s 90ms/step
15/15 [==============================] - 1s 2ms/step - loss: 4.5673
1/1 [==============================] - 0s 81ms/step
16/16 [==============================] - 1s 3ms/step - loss: 5.9326
1/1 [==============================] - 0s 84ms/step
17/17 [==============================] - 1s 3ms/step - loss: 5.2883
1/1 [==============================] - 0s 86ms/step
18/18 [==============================] - 1s 3ms/step - loss: 4.6034
1/1 [==============================] - 0s 85ms/step
18/18 [==============================] - 1s 3ms/step - loss: 3.8590
1/1 [==============================] - 0s 88ms/step
19/19 [==============================] - 1s 3ms/step - loss: 6.6191
1/1 [==============================] - 0s 84ms/step
20/20 [==============================] - 1s 3ms/step - loss: 5.4157
1/1 [==============================] - 0s 82ms/step
21/21 [==============================] - 1s 3ms/step - loss: 5.0215
1/1 [==============================] - 0s 87ms/step
21/21 [==============================] - 1s 2ms/step - loss: 5.8994
1/1 [==============================] - 0s 77ms/step
22/22 [==============================] - 1s 3ms/step - loss: 3.8560
1/1 [==============================] - 0s 89ms/step
23/23 [==============================] - 1s 3ms/step - loss: 5.2900
1/1 [==============================] - 0s 81ms/step
24/24 [==============================] - 1s 3ms/step - loss: 7.5483
1/1 [==============================] - 0s 90ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.9057
1/1 [==============================] - 0s 86ms/step
25/25 [==============================] - 1s 3ms/step - loss: 5.0862
1/1 [==============================] - 0s 77ms/step
26/26 [==============================] - 1s 3ms/step - loss: 7.1224
1/1 [==============================] - 0s 91ms/step
27/27 [==============================] - 1s 3ms/step - loss: 5.3666
1/1 [==============================] - 0s 81ms/step
27/27 [==============================] - 1s 3ms/step - loss: 5.2751
1/1 [==============================] - 0s 91ms/step
28/28 [==============================] - 1s 3ms/step - loss: 7.4747
1/1 [==============================] - 0s 90ms/step
29/29 [==============================] - 1s 3ms/step - loss: 6.0177
1/1 [==============================] - 0s 101ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.6254
1/1 [==============================] - 0s 84ms/step
30/30 [==============================] - 1s 3ms/step - loss: 4.9661
1/1 [==============================] - 0s 87ms/step
31/31 [==============================] - 1s 3ms/step - loss: 7.6595
1/1 [==============================] - 0s 80ms/step
32/32 [==============================] - 1s 3ms/step - loss: 6.0966
1/1 [==============================] - 0s 90ms/step
33/33 [==============================] - 1s 3ms/step - loss: 5.9804
1/1 [==============================] - 0s 83ms/step
33/33 [==============================] - 1s 3ms/step - loss: 5.6062
1/1 [==============================] - 0s 77ms/step
34/34 [==============================] - 1s 3ms/step - loss: 5.1290
1/1 [==============================] - 0s 88ms/step
35/35 [==============================] - 1s 3ms/step - loss: 5.8599
1/1 [==============================] - 0s 82ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.5568
1/1 [==============================] - 0s 88ms/step
36/36 [==============================] - 1s 3ms/step - loss: 3.9981
1/1 [==============================] - 0s 89ms/step
37/37 [==============================] - 1s 3ms/step - loss: 6.9107
1/1 [==============================] - 0s 96ms/step
38/38 [==============================] - 1s 3ms/step - loss: 5.4141
1/1 [==============================] - 0s 94ms/step
1/1 [==============================] - 1s 548ms/step - loss: 4.1006
1/1 [==============================] - 0s 84ms/step
2/2 [==============================] - 1s 5ms/step - loss: 1.5651
1/1 [==============================] - 0s 89ms/step
3/3 [==============================] - 1s 3ms/step - loss: 3.0674
1/1 [==============================] - 0s 88ms/step
3/3 [==============================] - 1s 5ms/step - loss: 4.4854
1/1 [==============================] - 0s 94ms/step
4/4 [==============================] - 1s 3ms/step - loss: 5.1911
1/1 [==============================] - 0s 80ms/step
5/5 [==============================] - 1s 3ms/step - loss: 5.7705
1/1 [==============================] - 0s 88ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.0796
1/1 [==============================] - 0s 81ms/step
6/6 [==============================] - 1s 2ms/step - loss: 6.8253
1/1 [==============================] - 0s 99ms/step
7/7 [==============================] - 1s 3ms/step - loss: 6.1014
1/1 [==============================] - 0s 78ms/step
8/8 [==============================] - 1s 3ms/step - loss: 6.1700
1/1 [==============================] - 0s 84ms/step
9/9 [==============================] - 1s 3ms/step - loss: 4.8334
1/1 [==============================] - 0s 86ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.5360
1/1 [==============================] - 0s 79ms/step
10/10 [==============================] - 1s 3ms/step - loss: 4.3919
1/1 [==============================] - 0s 83ms/step
11/11 [==============================] - 1s 3ms/step - loss: 7.6787
1/1 [==============================] - 0s 82ms/step
12/12 [==============================] - 1s 3ms/step - loss: 5.6701
1/1 [==============================] - 0s 83ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.6992
1/1 [==============================] - 0s 94ms/step
13/13 [==============================] - 1s 3ms/step - loss: 6.2349
1/1 [==============================] - 0s 88ms/step
14/14 [==============================] - 1s 3ms/step - loss: 6.7316
1/1 [==============================] - 0s 85ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.2970
1/1 [==============================] - 0s 80ms/step
15/15 [==============================] - 1s 3ms/step - loss: 4.5352
1/1 [==============================] - 0s 86ms/step
16/16 [==============================] - 1s 2ms/step - loss: 7.4204
1/1 [==============================] - 0s 88ms/step
17/17 [==============================] - 1s 2ms/step - loss: 5.5564
1/1 [==============================] - 0s 89ms/step
18/18 [==============================] - 1s 3ms/step - loss: 5.6282
1/1 [==============================] - 0s 87ms/step
18/18 [==============================] - 1s 3ms/step - loss: 8.3731
1/1 [==============================] - 0s 86ms/step
19/19 [==============================] - 1s 3ms/step - loss: 3.7698
1/1 [==============================] - 0s 83ms/step
20/20 [==============================] - 1s 3ms/step - loss: 7.1824
1/1 [==============================] - 0s 100ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.6167
1/1 [==============================] - 0s 86ms/step
21/21 [==============================] - 1s 3ms/step - loss: 5.5171
1/1 [==============================] - 0s 77ms/step
22/22 [==============================] - 1s 3ms/step - loss: 7.0760
1/1 [==============================] - 0s 82ms/step
23/23 [==============================] - 1s 3ms/step - loss: 5.1777
1/1 [==============================] - 0s 84ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.7823
1/1 [==============================] - 0s 80ms/step
24/24 [==============================] - 1s 2ms/step - loss: 4.1394
1/1 [==============================] - 0s 79ms/step
25/25 [==============================] - 1s 3ms/step - loss: 6.2280
1/1 [==============================] - 0s 93ms/step
26/26 [==============================] - 1s 3ms/step - loss: 6.4677
1/1 [==============================] - 0s 78ms/step
27/27 [==============================] - 1s 3ms/step - loss: 7.6654
1/1 [==============================] - 0s 80ms/step
27/27 [==============================] - 1s 2ms/step - loss: 7.0676
1/1 [==============================] - 0s 85ms/step
28/28 [==============================] - 1s 3ms/step - loss: 5.1154
1/1 [==============================] - 0s 91ms/step
29/29 [==============================] - 1s 3ms/step - loss: 5.2746
1/1 [==============================] - 0s 83ms/step
30/30 [==============================] - 1s 3ms/step - loss: 3.7571
1/1 [==============================] - 0s 85ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.6144
1/1 [==============================] - 0s 79ms/step
31/31 [==============================] - 1s 3ms/step - loss: 7.2301
1/1 [==============================] - 0s 79ms/step
32/32 [==============================] - 1s 3ms/step - loss: 5.0835
1/1 [==============================] - 0s 82ms/step
33/33 [==============================] - 1s 3ms/step - loss: 8.0846
1/1 [==============================] - 0s 81ms/step
33/33 [==============================] - 1s 2ms/step - loss: 6.4400
1/1 [==============================] - 0s 82ms/step
34/34 [==============================] - 1s 3ms/step - loss: 6.3900
1/1 [==============================] - 0s 79ms/step
35/35 [==============================] - 1s 2ms/step - loss: 6.1228
1/1 [==============================] - 0s 83ms/step
36/36 [==============================] - 1s 3ms/step - loss: 4.9948
1/1 [==============================] - 0s 82ms/step
36/36 [==============================] - 1s 2ms/step - loss: 7.3626
1/1 [==============================] - 0s 85ms/step
37/37 [==============================] - 1s 3ms/step - loss: 10.9381
1/1 [==============================] - 0s 86ms/step
38/38 [==============================] - 1s 3ms/step - loss: 5.0870
1/1 [==============================] - 0s 87ms/step
1/1 [==============================] - 1s 571ms/step - loss: 1.2590
1/1 [==============================] - 0s 93ms/step
2/2 [==============================] - 1s 6ms/step - loss: 3.6387
1/1 [==============================] - 0s 79ms/step
3/3 [==============================] - 1s 5ms/step - loss: 2.2270
1/1 [==============================] - 0s 83ms/step
3/3 [==============================] - 0s 5ms/step - loss: 4.5509
1/1 [==============================] - 0s 91ms/step
4/4 [==============================] - 1s 4ms/step - loss: 3.9234
1/1 [==============================] - 0s 81ms/step
5/5 [==============================] - 1s 3ms/step - loss: 5.6111
1/1 [==============================] - 0s 85ms/step
6/6 [==============================] - 1s 3ms/step - loss: 7.6832
1/1 [==============================] - 0s 81ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.4030
1/1 [==============================] - 0s 76ms/step
7/7 [==============================] - 1s 3ms/step - loss: 5.1438
1/1 [==============================] - 0s 84ms/step
8/8 [==============================] - 1s 3ms/step - loss: 6.3907
1/1 [==============================] - 0s 81ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.6351
1/1 [==============================] - 0s 88ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.7649
1/1 [==============================] - 0s 79ms/step
10/10 [==============================] - 1s 3ms/step - loss: 5.0494
1/1 [==============================] - 0s 84ms/step
11/11 [==============================] - 1s 3ms/step - loss: 7.3312
1/1 [==============================] - 0s 79ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.5868
1/1 [==============================] - 0s 91ms/step
12/12 [==============================] - 1s 3ms/step - loss: 7.6196
1/1 [==============================] - 0s 88ms/step
13/13 [==============================] - 1s 3ms/step - loss: 5.6655
1/1 [==============================] - 0s 78ms/step
14/14 [==============================] - 1s 3ms/step - loss: 3.5018
1/1 [==============================] - 0s 83ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.5270
1/1 [==============================] - 0s 87ms/step
15/15 [==============================] - 0s 3ms/step - loss: 5.2307
1/1 [==============================] - 0s 87ms/step
16/16 [==============================] - 1s 3ms/step - loss: 6.0998
1/1 [==============================] - 0s 90ms/step
17/17 [==============================] - 1s 3ms/step - loss: 5.4836
1/1 [==============================] - 0s 76ms/step
18/18 [==============================] - 1s 3ms/step - loss: 6.2491
1/1 [==============================] - 0s 84ms/step
18/18 [==============================] - 1s 3ms/step - loss: 7.4760
1/1 [==============================] - 0s 80ms/step
19/19 [==============================] - 1s 3ms/step - loss: 7.5499
1/1 [==============================] - 0s 87ms/step
20/20 [==============================] - 1s 3ms/step - loss: 4.9324
1/1 [==============================] - 0s 86ms/step
21/21 [==============================] - 1s 3ms/step - loss: 5.1483
1/1 [==============================] - 0s 90ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.1081
1/1 [==============================] - 0s 82ms/step
22/22 [==============================] - 1s 3ms/step - loss: 8.5610
1/1 [==============================] - 0s 81ms/step
23/23 [==============================] - 1s 3ms/step - loss: 6.7894
1/1 [==============================] - 0s 82ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.7810
1/1 [==============================] - 0s 79ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.5410
1/1 [==============================] - 0s 82ms/step
25/25 [==============================] - 1s 3ms/step - loss: 6.0684
1/1 [==============================] - 0s 88ms/step
26/26 [==============================] - 1s 3ms/step - loss: 6.6900
1/1 [==============================] - 0s 104ms/step
27/27 [==============================] - 1s 3ms/step - loss: 6.4394
1/1 [==============================] - 0s 87ms/step
27/27 [==============================] - 1s 3ms/step - loss: 7.5527
1/1 [==============================] - 0s 90ms/step
28/28 [==============================] - 1s 3ms/step - loss: 7.6027
1/1 [==============================] - 0s 111ms/step
29/29 [==============================] - 1s 3ms/step - loss: 6.3269
1/1 [==============================] - 0s 92ms/step
30/30 [==============================] - 1s 3ms/step - loss: 5.3506
1/1 [==============================] - 0s 85ms/step
30/30 [==============================] - 1s 2ms/step - loss: 4.4377
1/1 [==============================] - 0s 83ms/step
31/31 [==============================] - 1s 3ms/step - loss: 7.8951
1/1 [==============================] - 0s 86ms/step
32/32 [==============================] - 1s 3ms/step - loss: 6.1243
1/1 [==============================] - 0s 78ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.6992
1/1 [==============================] - 0s 84ms/step
33/33 [==============================] - 1s 3ms/step - loss: 8.8416
1/1 [==============================] - 0s 86ms/step
34/34 [==============================] - 1s 3ms/step - loss: 6.2065
1/1 [==============================] - 0s 86ms/step
35/35 [==============================] - 1s 3ms/step - loss: 5.4477
1/1 [==============================] - 0s 84ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.7048
1/1 [==============================] - 0s 89ms/step
36/36 [==============================] - 1s 2ms/step - loss: 7.6528
1/1 [==============================] - 0s 93ms/step
37/37 [==============================] - 1s 3ms/step - loss: 4.0049
1/1 [==============================] - 0s 88ms/step
38/38 [==============================] - 1s 3ms/step - loss: 8.1573
1/1 [==============================] - 0s 81ms/step
1/1 [==============================] - 1s 558ms/step - loss: 3.0033
1/1 [==============================] - 0s 89ms/step
2/2 [==============================] - 1s 6ms/step - loss: 3.0598
1/1 [==============================] - 0s 84ms/step
3/3 [==============================] - 1s 3ms/step - loss: 3.1748
1/1 [==============================] - 0s 84ms/step
3/3 [==============================] - 1s 3ms/step - loss: 4.4057
1/1 [==============================] - 0s 79ms/step
4/4 [==============================] - 1s 3ms/step - loss: 7.0468
1/1 [==============================] - 0s 77ms/step
5/5 [==============================] - 1s 3ms/step - loss: 6.3994
1/1 [==============================] - 0s 92ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.2097
1/1 [==============================] - 0s 84ms/step
6/6 [==============================] - 1s 3ms/step - loss: 9.7808
1/1 [==============================] - 0s 88ms/step
7/7 [==============================] - 1s 3ms/step - loss: 6.3239
1/1 [==============================] - 0s 77ms/step
8/8 [==============================] - 1s 3ms/step - loss: 6.2107
1/1 [==============================] - 0s 79ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.5008
1/1 [==============================] - 0s 92ms/step
9/9 [==============================] - 1s 8ms/step - loss: 6.7795
1/1 [==============================] - 0s 89ms/step
10/10 [==============================] - 1s 3ms/step - loss: 6.1567
1/1 [==============================] - 0s 85ms/step
11/11 [==============================] - 1s 3ms/step - loss: 8.1367
1/1 [==============================] - 0s 86ms/step
12/12 [==============================] - 1s 2ms/step - loss: 6.4141
1/1 [==============================] - 0s 78ms/step
12/12 [==============================] - 1s 2ms/step - loss: 7.6167
1/1 [==============================] - 0s 102ms/step
13/13 [==============================] - 1s 3ms/step - loss: 8.1043
1/1 [==============================] - 0s 104ms/step
14/14 [==============================] - 1s 3ms/step - loss: 4.3909
1/1 [==============================] - 0s 79ms/step
15/15 [==============================] - 1s 3ms/step - loss: 4.1361
1/1 [==============================] - 0s 82ms/step
15/15 [==============================] - 1s 3ms/step - loss: 5.4407
1/1 [==============================] - 0s 79ms/step
16/16 [==============================] - 1s 3ms/step - loss: 4.7919
1/1 [==============================] - 0s 93ms/step
17/17 [==============================] - 1s 3ms/step - loss: 5.1380
1/1 [==============================] - 0s 83ms/step
18/18 [==============================] - 1s 3ms/step - loss: 4.7888
1/1 [==============================] - 0s 80ms/step
18/18 [==============================] - 1s 3ms/step - loss: 4.3135
1/1 [==============================] - 0s 110ms/step
19/19 [==============================] - 1s 3ms/step - loss: 5.8373
1/1 [==============================] - 0s 90ms/step
20/20 [==============================] - 1s 4ms/step - loss: 6.7766
1/1 [==============================] - 0s 123ms/step
21/21 [==============================] - 1s 3ms/step - loss: 5.3902
1/1 [==============================] - 0s 80ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.3508
1/1 [==============================] - 0s 91ms/step
22/22 [==============================] - 1s 4ms/step - loss: 4.6133
1/1 [==============================] - 0s 105ms/step
23/23 [==============================] - 1s 3ms/step - loss: 4.6068
1/1 [==============================] - 0s 87ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.3443
1/1 [==============================] - 0s 80ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.0252
1/1 [==============================] - 0s 98ms/step
25/25 [==============================] - 1s 3ms/step - loss: 5.4435
1/1 [==============================] - 0s 81ms/step
26/26 [==============================] - 1s 3ms/step - loss: 4.5761
1/1 [==============================] - 0s 89ms/step
27/27 [==============================] - 1s 3ms/step - loss: 5.7239
1/1 [==============================] - 0s 86ms/step
27/27 [==============================] - 1s 2ms/step - loss: 5.0699
1/1 [==============================] - 0s 77ms/step
28/28 [==============================] - 1s 3ms/step - loss: 6.7083
1/1 [==============================] - 0s 81ms/step
29/29 [==============================] - 1s 3ms/step - loss: 6.2200
1/1 [==============================] - 0s 84ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.4104
1/1 [==============================] - 0s 107ms/step
30/30 [==============================] - 1s 3ms/step - loss: 4.5854
1/1 [==============================] - 0s 88ms/step
31/31 [==============================] - 1s 3ms/step - loss: 2.6336
1/1 [==============================] - 0s 93ms/step
32/32 [==============================] - 1s 3ms/step - loss: 3.4258
1/1 [==============================] - 0s 90ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.6951
1/1 [==============================] - 0s 86ms/step
33/33 [==============================] - 1s 3ms/step - loss: 5.6549
1/1 [==============================] - 0s 90ms/step
34/34 [==============================] - 1s 2ms/step - loss: 6.2854
1/1 [==============================] - 0s 89ms/step
35/35 [==============================] - 1s 3ms/step - loss: 6.1929
1/1 [==============================] - 0s 80ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.0827
1/1 [==============================] - 0s 90ms/step
36/36 [==============================] - 1s 3ms/step - loss: 3.7596
1/1 [==============================] - 0s 83ms/step
37/37 [==============================] - 1s 3ms/step - loss: 6.8907
1/1 [==============================] - 0s 84ms/step
38/38 [==============================] - 1s 3ms/step - loss: 5.8036
1/1 [==============================] - 0s 91ms/step
1/1 [==============================] - 1s 744ms/step - loss: 2.4242
1/1 [==============================] - 0s 76ms/step
2/2 [==============================] - 1s 6ms/step - loss: 3.8982
1/1 [==============================] - 0s 82ms/step
3/3 [==============================] - 1s 5ms/step - loss: 2.7338
1/1 [==============================] - 0s 95ms/step
3/3 [==============================] - 0s 3ms/step - loss: 4.4718
1/1 [==============================] - 0s 82ms/step
4/4 [==============================] - 1s 3ms/step - loss: 5.0342
1/1 [==============================] - 0s 76ms/step
5/5 [==============================] - 1s 3ms/step - loss: 5.5297
1/1 [==============================] - 0s 84ms/step
6/6 [==============================] - 1s 3ms/step - loss: 7.2334
1/1 [==============================] - 0s 85ms/step
6/6 [==============================] - 1s 2ms/step - loss: 6.5842
1/1 [==============================] - 0s 90ms/step
7/7 [==============================] - 1s 3ms/step - loss: 5.3034
1/1 [==============================] - 0s 94ms/step
8/8 [==============================] - 1s 3ms/step - loss: 4.2999
1/1 [==============================] - 0s 78ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.1362
1/1 [==============================] - 0s 76ms/step
9/9 [==============================] - 1s 3ms/step - loss: 4.7189
1/1 [==============================] - 0s 81ms/step
10/10 [==============================] - 1s 3ms/step - loss: 5.4465
1/1 [==============================] - 0s 85ms/step
11/11 [==============================] - 1s 3ms/step - loss: 5.4711
1/1 [==============================] - 0s 83ms/step
12/12 [==============================] - 1s 3ms/step - loss: 5.0363
1/1 [==============================] - 0s 87ms/step
12/12 [==============================] - 1s 2ms/step - loss: 7.0760
1/1 [==============================] - 0s 88ms/step
13/13 [==============================] - 1s 3ms/step - loss: 6.8444
1/1 [==============================] - 0s 80ms/step
14/14 [==============================] - 1s 3ms/step - loss: 5.8907
1/1 [==============================] - 0s 84ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.2749
1/1 [==============================] - 0s 81ms/step
15/15 [==============================] - 1s 2ms/step - loss: 4.7740
1/1 [==============================] - 0s 85ms/step
16/16 [==============================] - 1s 2ms/step - loss: 5.3158
1/1 [==============================] - 0s 91ms/step
17/17 [==============================] - 1s 3ms/step - loss: 4.9241
1/1 [==============================] - 0s 85ms/step
18/18 [==============================] - 1s 3ms/step - loss: 5.2185
1/1 [==============================] - 0s 82ms/step
18/18 [==============================] - 1s 3ms/step - loss: 4.7021
1/1 [==============================] - 0s 79ms/step
19/19 [==============================] - 1s 3ms/step - loss: 3.3747
1/1 [==============================] - 0s 86ms/step
20/20 [==============================] - 1s 3ms/step - loss: 5.7519
1/1 [==============================] - 0s 84ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.4448
1/1 [==============================] - 0s 82ms/step
21/21 [==============================] - 1s 3ms/step - loss: 4.7085
1/1 [==============================] - 0s 77ms/step
22/22 [==============================] - 1s 3ms/step - loss: 4.5388
1/1 [==============================] - 0s 87ms/step
23/23 [==============================] - 1s 3ms/step - loss: 5.3144
1/1 [==============================] - 0s 83ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.3443
1/1 [==============================] - 0s 101ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.9790
1/1 [==============================] - 0s 88ms/step
25/25 [==============================] - 1s 3ms/step - loss: 6.1567
1/1 [==============================] - 0s 82ms/step
26/26 [==============================] - 1s 3ms/step - loss: 6.3135
1/1 [==============================] - 0s 84ms/step
27/27 [==============================] - 1s 3ms/step - loss: 5.5854
1/1 [==============================] - 0s 79ms/step
27/27 [==============================] - 1s 3ms/step - loss: 4.5143
1/1 [==============================] - 0s 92ms/step
28/28 [==============================] - 1s 3ms/step - loss: 4.2323
1/1 [==============================] - 0s 90ms/step
29/29 [==============================] - 1s 3ms/step - loss: 5.2425
1/1 [==============================] - 0s 89ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.5160
1/1 [==============================] - 0s 94ms/step
30/30 [==============================] - 1s 3ms/step - loss: 5.3715
1/1 [==============================] - 0s 78ms/step
31/31 [==============================] - 1s 3ms/step - loss: 4.8503
1/1 [==============================] - 0s 85ms/step
32/32 [==============================] - 1s 4ms/step - loss: 5.2443
1/1 [==============================] - 0s 88ms/step
33/33 [==============================] - 1s 3ms/step - loss: 5.1288
1/1 [==============================] - 0s 85ms/step
33/33 [==============================] - 1s 3ms/step - loss: 3.3908
1/1 [==============================] - 0s 81ms/step
34/34 [==============================] - 1s 3ms/step - loss: 5.2269
1/1 [==============================] - 0s 81ms/step
35/35 [==============================] - 1s 3ms/step - loss: 5.5809
1/1 [==============================] - 0s 100ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.5105
1/1 [==============================] - 0s 485ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.3698
1/1 [==============================] - 0s 111ms/step
37/37 [==============================] - 1s 3ms/step - loss: 3.5492
1/1 [==============================] - 0s 88ms/step
38/38 [==============================] - 1s 3ms/step - loss: 4.8856
1/1 [==============================] - 0s 83ms/step
1/1 [==============================] - 1s 545ms/step - loss: 4.1777
1/1 [==============================] - 0s 87ms/step
2/2 [==============================] - 1s 6ms/step - loss: 2.7918
1/1 [==============================] - 0s 82ms/step
3/3 [==============================] - 1s 4ms/step - loss: 3.4177
1/1 [==============================] - 0s 88ms/step
3/3 [==============================] - 0s 4ms/step - loss: 4.6513
1/1 [==============================] - 0s 87ms/step
4/4 [==============================] - 1s 4ms/step - loss: 4.9854
1/1 [==============================] - 0s 88ms/step
5/5 [==============================] - 1s 3ms/step - loss: 5.8070
1/1 [==============================] - 0s 88ms/step
6/6 [==============================] - 1s 2ms/step - loss: 6.3392
1/1 [==============================] - 0s 83ms/step
6/6 [==============================] - 0s 2ms/step - loss: 7.3601
1/1 [==============================] - 0s 86ms/step
7/7 [==============================] - 1s 3ms/step - loss: 4.7796
1/1 [==============================] - 0s 83ms/step
8/8 [==============================] - 1s 3ms/step - loss: 5.7819
1/1 [==============================] - 0s 85ms/step
9/9 [==============================] - 1s 3ms/step - loss: 6.4780
1/1 [==============================] - 0s 95ms/step
9/9 [==============================] - 0s 3ms/step - loss: 6.2176
1/1 [==============================] - 0s 82ms/step
10/10 [==============================] - 1s 3ms/step - loss: 4.0701
1/1 [==============================] - 0s 86ms/step
11/11 [==============================] - 1s 3ms/step - loss: 4.8450
1/1 [==============================] - 0s 80ms/step
12/12 [==============================] - 1s 3ms/step - loss: 4.2480
1/1 [==============================] - 0s 90ms/step
12/12 [==============================] - 1s 3ms/step - loss: 5.4628
1/1 [==============================] - 0s 88ms/step
13/13 [==============================] - 1s 3ms/step - loss: 5.8607
1/1 [==============================] - 0s 85ms/step
14/14 [==============================] - 1s 2ms/step - loss: 5.7850
1/1 [==============================] - 0s 85ms/step
15/15 [==============================] - 1s 3ms/step - loss: 4.6326
1/1 [==============================] - 0s 92ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.2968
1/1 [==============================] - 0s 89ms/step
16/16 [==============================] - 1s 2ms/step - loss: 5.2952
1/1 [==============================] - 0s 84ms/step
17/17 [==============================] - 1s 3ms/step - loss: 5.7599
1/1 [==============================] - 0s 90ms/step
18/18 [==============================] - 1s 2ms/step - loss: 3.8270
1/1 [==============================] - 0s 83ms/step
18/18 [==============================] - 1s 3ms/step - loss: 5.0303
1/1 [==============================] - 0s 83ms/step
19/19 [==============================] - 1s 3ms/step - loss: 4.9652
1/1 [==============================] - 0s 92ms/step
20/20 [==============================] - 1s 2ms/step - loss: 6.0583
1/1 [==============================] - 0s 80ms/step
21/21 [==============================] - 1s 3ms/step - loss: 6.7385
1/1 [==============================] - 0s 80ms/step
21/21 [==============================] - 1s 2ms/step - loss: 5.7314
1/1 [==============================] - 0s 90ms/step
22/22 [==============================] - 1s 3ms/step - loss: 5.5310
1/1 [==============================] - 0s 79ms/step
23/23 [==============================] - 1s 2ms/step - loss: 7.7752
1/1 [==============================] - 0s 85ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.3406
1/1 [==============================] - 0s 86ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.7541
1/1 [==============================] - 0s 88ms/step
25/25 [==============================] - 1s 3ms/step - loss: 5.5474
1/1 [==============================] - 0s 79ms/step
26/26 [==============================] - 1s 3ms/step - loss: 4.8275
1/1 [==============================] - 0s 78ms/step
27/27 [==============================] - 1s 3ms/step - loss: 6.4549
1/1 [==============================] - 0s 82ms/step
27/27 [==============================] - 1s 3ms/step - loss: 5.5389
1/1 [==============================] - 0s 86ms/step
28/28 [==============================] - 1s 3ms/step - loss: 4.6406
1/1 [==============================] - 0s 89ms/step
29/29 [==============================] - 1s 3ms/step - loss: 5.3359
1/1 [==============================] - 0s 78ms/step
30/30 [==============================] - 1s 2ms/step - loss: 5.3802
1/1 [==============================] - 0s 82ms/step
30/30 [==============================] - 1s 3ms/step - loss: 9.2537
1/1 [==============================] - 0s 88ms/step
31/31 [==============================] - 1s 2ms/step - loss: 7.3174
1/1 [==============================] - 0s 84ms/step
32/32 [==============================] - 1s 3ms/step - loss: 6.3766
1/1 [==============================] - 0s 80ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.2808
1/1 [==============================] - 0s 79ms/step
33/33 [==============================] - 1s 3ms/step - loss: 5.0364
1/1 [==============================] - 0s 86ms/step
34/34 [==============================] - 1s 3ms/step - loss: 3.6704
1/1 [==============================] - 0s 95ms/step
35/35 [==============================] - 1s 2ms/step - loss: 7.3874
1/1 [==============================] - 0s 86ms/step
36/36 [==============================] - 1s 3ms/step - loss: 6.2325
1/1 [==============================] - 0s 78ms/step
36/36 [==============================] - 1s 2ms/step - loss: 5.6707
1/1 [==============================] - 0s 80ms/step
37/37 [==============================] - 1s 3ms/step - loss: 4.3895
1/1 [==============================] - 0s 77ms/step
38/38 [==============================] - 1s 3ms/step - loss: 6.3559
1/1 [==============================] - 0s 82ms/step
1/1 [==============================] - 1s 949ms/step - loss: 2.0665
1/1 [==============================] - 0s 78ms/step
2/2 [==============================] - 1s 6ms/step - loss: 3.0344
1/1 [==============================] - 0s 80ms/step
3/3 [==============================] - 1s 4ms/step - loss: 2.8932
1/1 [==============================] - 0s 82ms/step
3/3 [==============================] - 1s 4ms/step - loss: 2.3582
1/1 [==============================] - 0s 86ms/step
4/4 [==============================] - 1s 4ms/step - loss: 3.6281
1/1 [==============================] - 0s 81ms/step
5/5 [==============================] - 1s 3ms/step - loss: 6.7105
1/1 [==============================] - 0s 86ms/step
6/6 [==============================] - 1s 3ms/step - loss: 8.2413
1/1 [==============================] - 0s 80ms/step
6/6 [==============================] - 0s 3ms/step - loss: 6.2300
1/1 [==============================] - 0s 85ms/step
7/7 [==============================] - 1s 3ms/step - loss: 7.0576
1/1 [==============================] - 0s 80ms/step
8/8 [==============================] - 1s 3ms/step - loss: 8.1876
1/1 [==============================] - 0s 82ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.9870
1/1 [==============================] - 0s 83ms/step
9/9 [==============================] - 1s 2ms/step - loss: 5.1603
1/1 [==============================] - 0s 75ms/step
10/10 [==============================] - 1s 3ms/step - loss: 5.5567
1/1 [==============================] - 0s 82ms/step
11/11 [==============================] - 1s 3ms/step - loss: 5.3022
1/1 [==============================] - 0s 84ms/step
12/12 [==============================] - 1s 3ms/step - loss: 8.4849
1/1 [==============================] - 0s 74ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.9819
1/1 [==============================] - 0s 83ms/step
13/13 [==============================] - 1s 3ms/step - loss: 6.7663
1/1 [==============================] - 0s 80ms/step
14/14 [==============================] - 1s 3ms/step - loss: 5.1407
1/1 [==============================] - 0s 80ms/step
15/15 [==============================] - 1s 3ms/step - loss: 6.0301
1/1 [==============================] - 0s 77ms/step
15/15 [==============================] - 1s 3ms/step - loss: 5.9469
1/1 [==============================] - 0s 77ms/step
16/16 [==============================] - 1s 3ms/step - loss: 6.1256
1/1 [==============================] - 0s 81ms/step
17/17 [==============================] - 1s 3ms/step - loss: 5.6237
1/1 [==============================] - 0s 82ms/step
18/18 [==============================] - 1s 3ms/step - loss: 5.5338
1/1 [==============================] - 0s 107ms/step
18/18 [==============================] - 1s 3ms/step - loss: 4.3136
1/1 [==============================] - 0s 83ms/step
19/19 [==============================] - 1s 3ms/step - loss: 6.0043
1/1 [==============================] - 0s 82ms/step
20/20 [==============================] - 1s 2ms/step - loss: 5.5602
1/1 [==============================] - 0s 94ms/step
21/21 [==============================] - 1s 3ms/step - loss: 5.6025
1/1 [==============================] - 0s 87ms/step
21/21 [==============================] - 1s 3ms/step - loss: 4.4528
1/1 [==============================] - 0s 87ms/step
22/22 [==============================] - 1s 3ms/step - loss: 4.3008
1/1 [==============================] - 0s 79ms/step
23/23 [==============================] - 1s 3ms/step - loss: 5.8999
1/1 [==============================] - 0s 82ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.5219
1/1 [==============================] - 0s 83ms/step
24/24 [==============================] - 1s 3ms/step - loss: 6.5759
1/1 [==============================] - 0s 81ms/step
25/25 [==============================] - 1s 3ms/step - loss: 7.2545
1/1 [==============================] - 0s 84ms/step
26/26 [==============================] - 1s 3ms/step - loss: 5.8570
1/1 [==============================] - 0s 83ms/step
27/27 [==============================] - 1s 3ms/step - loss: 5.2132
1/1 [==============================] - 0s 88ms/step
27/27 [==============================] - 1s 2ms/step - loss: 4.9152
1/1 [==============================] - 0s 82ms/step
28/28 [==============================] - 1s 3ms/step - loss: 6.8190
1/1 [==============================] - 0s 84ms/step
29/29 [==============================] - 1s 2ms/step - loss: 4.8349
1/1 [==============================] - 0s 83ms/step
30/30 [==============================] - 1s 3ms/step - loss: 6.6379
1/1 [==============================] - 0s 93ms/step
30/30 [==============================] - 1s 3ms/step - loss: 4.9721
1/1 [==============================] - 0s 77ms/step
31/31 [==============================] - 1s 3ms/step - loss: 6.8563
1/1 [==============================] - 0s 79ms/step
32/32 [==============================] - 1s 3ms/step - loss: 5.0834
1/1 [==============================] - 0s 78ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.5621
1/1 [==============================] - 0s 83ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.0536
1/1 [==============================] - 0s 76ms/step
34/34 [==============================] - 1s 3ms/step - loss: 5.3146
1/1 [==============================] - 0s 90ms/step
35/35 [==============================] - 1s 3ms/step - loss: 7.2078
1/1 [==============================] - 0s 80ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.9097
1/1 [==============================] - 0s 83ms/step
36/36 [==============================] - 1s 3ms/step - loss: 6.6988
1/1 [==============================] - 0s 91ms/step
37/37 [==============================] - 1s 3ms/step - loss: 4.6499
1/1 [==============================] - 0s 85ms/step
38/38 [==============================] - 1s 3ms/step - loss: 5.2893
1/1 [==============================] - 0s 84ms/step
1/1 [==============================] - 1s 523ms/step - loss: 2.5129
1/1 [==============================] - 0s 486ms/step
2/2 [==============================] - 1s 4ms/step - loss: 3.2265
1/1 [==============================] - 0s 85ms/step
3/3 [==============================] - 1s 3ms/step - loss: 6.2815
1/1 [==============================] - 0s 74ms/step
3/3 [==============================] - 0s 3ms/step - loss: 2.4763
1/1 [==============================] - 0s 83ms/step
4/4 [==============================] - 1s 4ms/step - loss: 4.5402
1/1 [==============================] - 0s 81ms/step
5/5 [==============================] - 1s 3ms/step - loss: 6.5771
1/1 [==============================] - 0s 80ms/step
6/6 [==============================] - 1s 3ms/step - loss: 7.2464
1/1 [==============================] - 0s 89ms/step
6/6 [==============================] - 1s 3ms/step - loss: 6.0643
1/1 [==============================] - 0s 84ms/step
7/7 [==============================] - 1s 3ms/step - loss: 7.1124
1/1 [==============================] - 0s 86ms/step
8/8 [==============================] - 1s 3ms/step - loss: 6.4253
1/1 [==============================] - 0s 84ms/step
9/9 [==============================] - 1s 2ms/step - loss: 6.6780
1/1 [==============================] - 0s 91ms/step
9/9 [==============================] - 1s 2ms/step - loss: 6.7321
1/1 [==============================] - 0s 89ms/step
10/10 [==============================] - 1s 3ms/step - loss: 5.0585
1/1 [==============================] - 0s 92ms/step
11/11 [==============================] - 1s 2ms/step - loss: 5.5859
1/1 [==============================] - 0s 87ms/step
12/12 [==============================] - 1s 3ms/step - loss: 6.2316
1/1 [==============================] - 0s 90ms/step
12/12 [==============================] - 0s 3ms/step - loss: 7.2691
1/1 [==============================] - 0s 84ms/step
13/13 [==============================] - 1s 3ms/step - loss: 6.2885
1/1 [==============================] - 0s 76ms/step
14/14 [==============================] - 1s 3ms/step - loss: 4.3145
1/1 [==============================] - 0s 79ms/step
15/15 [==============================] - 1s 3ms/step - loss: 5.2294
1/1 [==============================] - 0s 79ms/step
15/15 [==============================] - 1s 3ms/step - loss: 5.7945
1/1 [==============================] - 0s 91ms/step
16/16 [==============================] - 1s 3ms/step - loss: 4.3440
1/1 [==============================] - 0s 82ms/step
17/17 [==============================] - 1s 4ms/step - loss: 5.5227
1/1 [==============================] - 0s 81ms/step
18/18 [==============================] - 1s 3ms/step - loss: 4.1191
1/1 [==============================] - 0s 82ms/step
18/18 [==============================] - 1s 2ms/step - loss: 5.7466
1/1 [==============================] - 0s 84ms/step
19/19 [==============================] - 1s 3ms/step - loss: 4.5692
1/1 [==============================] - 0s 89ms/step
20/20 [==============================] - 1s 3ms/step - loss: 4.1316
1/1 [==============================] - 0s 77ms/step
21/21 [==============================] - 1s 3ms/step - loss: 3.6072
1/1 [==============================] - 0s 84ms/step
21/21 [==============================] - 1s 2ms/step - loss: 5.9407
1/1 [==============================] - 0s 86ms/step
22/22 [==============================] - 1s 3ms/step - loss: 7.3033
1/1 [==============================] - 0s 126ms/step
23/23 [==============================] - 1s 3ms/step - loss: 4.4760
1/1 [==============================] - 0s 84ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.4298
1/1 [==============================] - 0s 81ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.6835
1/1 [==============================] - 0s 84ms/step
25/25 [==============================] - 1s 3ms/step - loss: 6.2935
1/1 [==============================] - 0s 82ms/step
26/26 [==============================] - 1s 3ms/step - loss: 4.6413
1/1 [==============================] - 0s 84ms/step
27/27 [==============================] - 1s 3ms/step - loss: 6.7357
1/1 [==============================] - 0s 84ms/step
27/27 [==============================] - 1s 3ms/step - loss: 6.2542
1/1 [==============================] - 0s 80ms/step
28/28 [==============================] - 1s 3ms/step - loss: 5.4887
1/1 [==============================] - 0s 89ms/step
29/29 [==============================] - 1s 3ms/step - loss: 2.9799
1/1 [==============================] - 0s 91ms/step
30/30 [==============================] - 1s 3ms/step - loss: 5.0942
1/1 [==============================] - 0s 78ms/step
30/30 [==============================] - 1s 3ms/step - loss: 5.0248
1/1 [==============================] - 0s 85ms/step
31/31 [==============================] - 1s 3ms/step - loss: 4.6751
1/1 [==============================] - 0s 83ms/step
32/32 [==============================] - 1s 3ms/step - loss: 4.8085
1/1 [==============================] - 0s 88ms/step
33/33 [==============================] - 1s 3ms/step - loss: 4.6135
1/1 [==============================] - 0s 81ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.6960
1/1 [==============================] - 0s 90ms/step
34/34 [==============================] - 1s 3ms/step - loss: 6.0882
1/1 [==============================] - 0s 89ms/step
35/35 [==============================] - 1s 3ms/step - loss: 5.7968
1/1 [==============================] - 0s 87ms/step
36/36 [==============================] - 1s 3ms/step - loss: 6.5022
1/1 [==============================] - 0s 83ms/step
36/36 [==============================] - 1s 3ms/step - loss: 7.9264
1/1 [==============================] - 0s 86ms/step
37/37 [==============================] - 1s 3ms/step - loss: 4.5660
1/1 [==============================] - 0s 118ms/step
38/38 [==============================] - 1s 3ms/step - loss: 3.0778
1/1 [==============================] - 0s 84ms/step
1/1 [==============================] - 1s 544ms/step - loss: 2.8661
1/1 [==============================] - 0s 81ms/step
2/2 [==============================] - 1s 5ms/step - loss: 3.6306
1/1 [==============================] - 0s 73ms/step
3/3 [==============================] - 1s 4ms/step - loss: 3.2094
1/1 [==============================] - 0s 79ms/step
3/3 [==============================] - 0s 3ms/step - loss: 5.5152
1/1 [==============================] - 0s 81ms/step
4/4 [==============================] - 1s 3ms/step - loss: 5.5676
1/1 [==============================] - 0s 93ms/step
5/5 [==============================] - 1s 3ms/step - loss: 5.6668
1/1 [==============================] - 0s 85ms/step
6/6 [==============================] - 1s 3ms/step - loss: 5.7845
1/1 [==============================] - 0s 80ms/step
6/6 [==============================] - 0s 5ms/step - loss: 6.4911
1/1 [==============================] - 0s 79ms/step
7/7 [==============================] - 1s 3ms/step - loss: 5.3614
1/1 [==============================] - 0s 82ms/step
8/8 [==============================] - 1s 3ms/step - loss: 5.1864
1/1 [==============================] - 0s 74ms/step
9/9 [==============================] - 1s 2ms/step - loss: 5.1471
1/1 [==============================] - 0s 81ms/step
9/9 [==============================] - 1s 3ms/step - loss: 5.7588
1/1 [==============================] - 0s 80ms/step
10/10 [==============================] - 1s 3ms/step - loss: 6.9082
1/1 [==============================] - 0s 85ms/step
11/11 [==============================] - 1s 3ms/step - loss: 6.3019
1/1 [==============================] - 0s 85ms/step
12/12 [==============================] - 1s 2ms/step - loss: 6.0034
1/1 [==============================] - 0s 84ms/step
12/12 [==============================] - 0s 2ms/step - loss: 7.0490
1/1 [==============================] - 0s 103ms/step
13/13 [==============================] - 1s 3ms/step - loss: 5.1861
1/1 [==============================] - 0s 85ms/step
14/14 [==============================] - 1s 3ms/step - loss: 5.4070
1/1 [==============================] - 0s 80ms/step
15/15 [==============================] - 1s 2ms/step - loss: 5.1680
1/1 [==============================] - 0s 91ms/step
15/15 [==============================] - 1s 3ms/step - loss: 4.3639
1/1 [==============================] - 0s 83ms/step
16/16 [==============================] - 1s 3ms/step - loss: 4.7783
1/1 [==============================] - 0s 85ms/step
17/17 [==============================] - 1s 3ms/step - loss: 3.6391
1/1 [==============================] - 0s 84ms/step
18/18 [==============================] - 1s 3ms/step - loss: 5.0835
1/1 [==============================] - 0s 82ms/step
18/18 [==============================] - 1s 3ms/step - loss: 5.6155
1/1 [==============================] - 0s 76ms/step
19/19 [==============================] - 1s 3ms/step - loss: 5.1254
1/1 [==============================] - 0s 80ms/step
20/20 [==============================] - 1s 3ms/step - loss: 6.2730
1/1 [==============================] - 0s 90ms/step
21/21 [==============================] - 1s 3ms/step - loss: 5.0575
1/1 [==============================] - 0s 92ms/step
21/21 [==============================] - 1s 3ms/step - loss: 5.1748
1/1 [==============================] - 0s 86ms/step
22/22 [==============================] - 1s 3ms/step - loss: 4.4880
1/1 [==============================] - 0s 83ms/step
23/23 [==============================] - 1s 3ms/step - loss: 6.5036
1/1 [==============================] - 0s 88ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.8406
1/1 [==============================] - 0s 78ms/step
24/24 [==============================] - 1s 3ms/step - loss: 5.6137
1/1 [==============================] - 0s 85ms/step
25/25 [==============================] - 1s 3ms/step - loss: 6.1283
1/1 [==============================] - 0s 111ms/step
26/26 [==============================] - 1s 3ms/step - loss: 5.1066
1/1 [==============================] - 0s 80ms/step
27/27 [==============================] - 1s 3ms/step - loss: 6.8865
1/1 [==============================] - 0s 84ms/step
27/27 [==============================] - 1s 3ms/step - loss: 3.9298
1/1 [==============================] - 0s 90ms/step
28/28 [==============================] - 1s 3ms/step - loss: 6.2691
1/1 [==============================] - 0s 83ms/step
29/29 [==============================] - 1s 3ms/step - loss: 5.5649
1/1 [==============================] - 0s 79ms/step
30/30 [==============================] - 1s 3ms/step - loss: 5.6316
1/1 [==============================] - 0s 80ms/step
30/30 [==============================] - 1s 3ms/step - loss: 5.2250
1/1 [==============================] - 0s 81ms/step
31/31 [==============================] - 1s 3ms/step - loss: 6.4040
1/1 [==============================] - 0s 79ms/step
32/32 [==============================] - 1s 3ms/step - loss: 5.4635
1/1 [==============================] - 0s 85ms/step
33/33 [==============================] - 1s 3ms/step - loss: 6.6331
1/1 [==============================] - 0s 85ms/step
33/33 [==============================] - 1s 2ms/step - loss: 4.9565
1/1 [==============================] - 0s 135ms/step
34/34 [==============================] - 1s 3ms/step - loss: 5.3427
1/1 [==============================] - 0s 83ms/step
35/35 [==============================] - 1s 3ms/step - loss: 3.3327
1/1 [==============================] - 0s 77ms/step
36/36 [==============================] - 1s 3ms/step - loss: 5.4917
1/1 [==============================] - 0s 87ms/step
36/36 [==============================] - 1s 3ms/step - loss: 3.4859
1/1 [==============================] - 0s 80ms/step
37/37 [==============================] - 1s 3ms/step - loss: 5.8594
1/1 [==============================] - 0s 80ms/step
38/38 [==============================] - 1s 3ms/step - loss: 5.3466
1/1 [==============================] - 0s 82ms/step
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(30, 30)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lowest_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.140124174789503
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Set up the model: model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>

<span class="c1"># Add the first layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_cols</span><span class="p">,)))</span>

<span class="c1"># Add the second layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>

<span class="c1"># Add the output layer</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># Compile the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">loss</span> <span class="o">=</span> <span class="s1">&#39;mean_squared_error&#39;</span><span class="p">)</span>

<span class="c1"># Fit the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">r2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2056/2056 [==============================] - 6s 2ms/step - loss: 0.5126
686/686 [==============================] - 1s 2ms/step
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.789838058100607
</pre></div>
</div>
</div>
</div>
</section>
<section id="conclusiones">
<h2>Conclusiones<a class="headerlink" href="#conclusiones" title="Permalink to this heading">#</a></h2>
<p>Pese a que se pidió evaluar los modelos con MAPE, RMSE y <span class="math notranslate nohighlight">\(R^2\)</span>. La métrica MAPE no fué calculada, a continuación las razones:</p>
<ul class="simple">
<li><p>La variable <strong>velocidad del viento</strong> tiene valores de cero. Entonces cuando se calculaba el error porcentual entre el valor predicho y el valor real, en esos registros, el resultado de la división era <strong>indefinido</strong></p></li>
<li><p>Otra opción era poner un número extramadamente pequeño en el denominador para que la operación fuese almenos posible. Pero eso ocasionaba valores de MAPE extremadamente altos que no tienen sentido desde el punto de vista de evaluación de modelo.</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Modelo</p></th>
<th class="head"><p>RMSE</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(R^2\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>KNN</p></td>
<td><p>0.8228</p></td>
<td><p>0.7899</p></td>
</tr>
<tr class="row-odd"><td><p>Ridge</p></td>
<td><p>0.8568</p></td>
<td><p>0.7736</p></td>
</tr>
<tr class="row-even"><td><p>Lasso</p></td>
<td><p>0.8576</p></td>
<td><p>0.7551</p></td>
</tr>
<tr class="row-odd"><td><p>XGBoost</p></td>
<td><p>0.8568</p></td>
<td><p>0.7962</p></td>
</tr>
<tr class="row-even"><td><p>SVM</p></td>
<td><p>0.8153</p></td>
<td><p>0.7927</p></td>
</tr>
<tr class="row-odd"><td><p>MLP</p></td>
<td><p>2.1401</p></td>
<td><p>0.7898</p></td>
</tr>
</tbody>
</table>
<p>Entonces, el modelo con el mejor valor de RMSE es la regresión mediante support vector machine, el mismo modelo tiene el segundo mejor <span class="math notranslate nohighlight">\(R^2\)</span>, por lo cuál es el modelo que mejor generaliza a los datos de predicción del viento.</p>
</section>
<section id="limitaciones">
<h2>Limitaciones<a class="headerlink" href="#limitaciones" title="Permalink to this heading">#</a></h2>
<p>Para efectos de la evaluación de los modelos, hay que considerar que por temas de tiempo de ejecución, se consideró solo 50 folds (que equivalen a 50 días de X_train en este caso)</p>
<p>Cabe la posibilidad de haber tenido mejores scores en RMSE y <span class="math notranslate nohighlight">\(R^2\)</span> con un mayor numero de folds (y por ende volumen de datos de entrenamiento), pero se deja abierto a la discusión para posteriores ejecuciones.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="wind_speed_data_EDA.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Wind Speed Data: EDA</p>
      </div>
    </a>
    <a class="right-next"
       href="fraud_detection_data_EDA.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fraud Detection Data: EDA</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#disenando-loop-para-particiones-de-entrenamiento-y-validacion">Diseñando loop para particiones de entrenamiento y validación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#knn">KNN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-regression">Ridge Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-regression">Lasso Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xg-boost">XG Boost</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#svm">SVM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp">MLP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">Conclusiones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitaciones">Limitaciones</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Martin Alvarez
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>